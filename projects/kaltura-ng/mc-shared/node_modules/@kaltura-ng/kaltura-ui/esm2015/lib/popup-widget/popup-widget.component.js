import { __decorate, __metadata } from "tslib";
import { Component, AfterViewInit, EventEmitter, OnDestroy, Input, Output, ElementRef, HostListener, TemplateRef, ContentChild, Renderer2, HostBinding } from "@angular/core";
import { BehaviorSubject } from 'rxjs/BehaviorSubject';
import { PopupWidgetLayout } from './popup-widget-layout';
import 'rxjs/add/observable/fromEvent';
import { cancelOnDestroy } from '@kaltura-ng/kaltura-common';
export const PopupWidgetStates = {
    "Open": "open",
    "BeforeClose": "beforeClose",
    "Close": "close",
    "Disabled": "disabled"
};
const WINDOW_GUTTER = 16;
let PopupWidgetComponent = class PopupWidgetComponent {
    constructor(popup, renderer) {
        this.popup = popup;
        this.renderer = renderer;
        this.transparent = false;
        this.popupHeight = 'auto';
        this.showTooltip = false;
        this.preventPageScroll = false;
        this.modal = false;
        this.slider = false;
        this.fullScreen = false;
        this.closeBtn = true;
        this.closeBtnInside = false;
        this.closeOnClickOutside = true;
        this.closeOnResize = false;
        this.closeOnBrowserNav = true;
        this.targetOffset = { 'x': 0, 'y': 0 };
        this.childrenPopups = [];
        this.trigger = 'click';
        this.placement = { x: 'right', y: 'bottom' };
        this.closeOnScroll = false;
        this.opened = false;
        this.closed = false;
        this._toggleFunc = this.toggle.bind(this);
        this._openFunc = this.open.bind(this);
        this._closeFunc = this.close.bind(this);
        this._viewInitialize = false;
        this.onOpen = new EventEmitter();
        this.onClose = new EventEmitter();
        this._stateChangeSubscription = null;
        this._statechange = new BehaviorSubject({ state: '' });
        this.state$ = this._statechange.asObservable();
        this._statechange.next({ state: PopupWidgetStates.Close });
        this.state$
            .pipe(cancelOnDestroy(this))
            .subscribe(({ state }) => {
            this.closed = state === PopupWidgetStates.Close;
            this.opened = state === PopupWidgetStates.Open;
        });
    }
    set targetRef(targetRef) {
        if (this.trigger === 'click') {
            if (this._targetRef) {
                this._targetRef.removeEventListener('click', this._toggleFunc);
            }
            this._targetRef = targetRef;
            if (this._targetRef) {
                this._targetRef.addEventListener('click', this._toggleFunc);
            }
        }
        else if (this.trigger === 'hover') {
            if (this._targetRef) {
                this._targetRef.removeEventListener('mouseover', this._openFunc);
                this._targetRef.removeEventListener('mouseout', this._closeFunc);
            }
            this._targetRef = targetRef;
            if (this._targetRef) {
                this._targetRef.addEventListener('mouseover', this._openFunc);
                this._targetRef.addEventListener('mouseout', this._closeFunc);
            }
        }
    }
    get targetRef() { return this._targetRef; }
    set parentPopup(parentPopup) {
        this._parentPopup = parentPopup;
        if (this._stateChangeSubscription) {
            this._stateChangeSubscription.unsubscribe();
            this._stateChangeSubscription = null;
        }
        if (this._parentPopup) {
            this._stateChangeSubscription = this._parentPopup.state$.subscribe(event => {
                if (event.state === PopupWidgetStates.Close) {
                    this.close();
                }
            });
        }
    }
    get parentPopup() { return this._parentPopup; }
    // public API methods
    open() {
        if (this.isEnabled && this.validate()) {
            // handle auto height
            if (!this.popupHeight || this.popupHeight === 'auto') {
                if (this.slider) {
                    this._popupWidgetHeight = 'calc(100vh - 80px)';
                }
                else {
                    this._popupWidgetHeight = 'auto';
                }
            }
            else {
                this._popupWidgetHeight = this.popupHeight + "px";
            }
            this._saveScrollPosition = window.pageYOffset || document.documentElement.scrollTop;
            // set location according to targetRef
            const parentLeft = this.appendTo && !this.modal ? this.appendTo.getBoundingClientRect().left : 0;
            const parentTop = this.appendTo && !this.modal ? this.appendTo.getBoundingClientRect().top : 0;
            // center on screen if no targetRef was defined
            if (!this._targetRef) {
                if (this.fullScreen) {
                    this.modal = false;
                    this.preventPageScroll = true;
                    this.renderer.addClass(this.popup.nativeElement, 'fullScreen');
                }
                else {
                    this.popup.nativeElement.style.marginLeft = window.innerWidth / 2 - this.popupWidth / 2 + 'px';
                    if (this.slider) {
                        window.scrollTo(0, 0);
                        this.popup.nativeElement.style.top = "auto";
                        this.closeBtn = false;
                        this.preventPageScroll = true;
                        this.popup.nativeElement.style.bottom = this.popupHeight !== 'auto' ? this.popupHeight * -1 + "px" : "-1000px";
                        setTimeout(() => {
                            this.popup.nativeElement.style.bottom = 0 + "px"; // use timeout to invoke animation
                        }, 0);
                    }
                    else {
                        const marginTop = (window.innerHeight / 2 - 100 / 2);
                        this.popup.nativeElement.style.marginTop = marginTop + 'px';
                        this.popup.nativeElement.style.position = "fixed";
                    }
                }
            }
            else {
                this.popup.nativeElement.style.marginLeft = this._targetRef.getBoundingClientRect().left - parentLeft + this.targetOffset['x'] + 'px';
                this.popup.nativeElement.style.marginTop = this._targetRef.getBoundingClientRect().top - parentTop + this.targetOffset['y'] + 'px';
                this.popup.nativeElement.style.position = "absolute";
            }
            this.popup.nativeElement.style.zIndex = PopupWidgetLayout.getPopupZindex(this.fullScreen);
            // handle modal
            if (!this._modalOverlay) {
                if (this.trigger !== 'hover') {
                    this._modalOverlay = document.createElement('div');
                    if (this.modal || this.slider) {
                        this._modalOverlay.className = "kPopupWidgetModalOverlay";
                    }
                    else {
                        this._modalOverlay.className = "kPopupWidgetModalOverlay kTransparent";
                    }
                    this._modalOverlay.style.zIndex = this.popup.nativeElement.style.zIndex - 1;
                    if (!this.slider && this.closeOnClickOutside) {
                        this._modalOverlay.addEventListener("mousedown", (event) => {
                            event.stopPropagation();
                            this.close();
                        });
                    }
                    if (this.appendTo) {
                        this.appendChild(this._modalOverlay, this.appendTo);
                    }
                    else {
                        document.body.appendChild(this._modalOverlay);
                    }
                    if (this.modal || this.slider) {
                        PopupWidgetLayout.increaseModalCount();
                    }
                }
            }
            // prevent page scroll
            if (this.preventPageScroll) {
                document.body.style.overflowY = 'hidden';
                document.body.style.position = 'fixed';
            }
            setTimeout(() => {
                this.addClickOutsideSupport();
            }, 0);
            this.onOpen.emit(); // dispatch onOpen event (API)
            this._statechange.next({ state: PopupWidgetStates.Open });
            if (this.closeOnScroll && this.isShow) {
                window.addEventListener('scroll', this._closeFunc);
            }
        }
        if (!this.slider && !this.fullScreen && this.popup.nativeElement) {
            this.popup.nativeElement.style.opacity = 0;
        }
        // auto positioning need first the dom to render
        setTimeout(() => {
            this.setPosition();
        }, 0);
    }
    close(context = null, reason = null) {
        if (this.isEnabled && this.isShow) {
            window.removeEventListener('scroll', this._closeFunc);
            if (this.fullScreen) {
                this.renderer.removeClass(this.popup.nativeElement, 'fullScreen');
            }
            // allow cancelling the close operation
            let beforeCloseContext = { "allowClose": true };
            this._statechange.next({ state: PopupWidgetStates.BeforeClose, context: beforeCloseContext });
            if (beforeCloseContext['allowClose']) {
                // close children popups if exist
                if (this.childrenPopups.length) {
                    this.childrenPopups.forEach((popup) => {
                        popup.close();
                    });
                }
                this.removeClickOutsideSupport();
                this.restorePageScroll(true);
                this.onClose.emit(); // dispatch onClose event (API)
                let timeout = 0;
                if (this.slider) {
                    this.popup.nativeElement.style.bottom = this.popupHeight !== 'auto' ? this.popupHeight * -1 + "px" : "-1000px";
                    timeout = 300;
                }
                if (this.modal && !this.slider) {
                    PopupWidgetLayout.decreaseModalCount();
                }
                setTimeout(() => {
                    // remove modal
                    if (this._modalOverlay) {
                        if (this.appendTo) {
                            this.removeChild(this._modalOverlay, this.appendTo);
                        }
                        else {
                            document.body.removeChild(this._modalOverlay);
                        }
                        this._modalOverlay = null;
                    }
                    if (this.slider) {
                        PopupWidgetLayout.decreaseModalCount();
                    }
                    this._statechange.next({ state: PopupWidgetStates.Close, context: context, reason: reason }); // use timeout to prevent valueChangeAfterChecked error
                }, timeout);
            }
        }
    }
    toggle() {
        if (this.isEnabled) {
            this.isShow ? this.close() : this.open();
        }
    }
    get isShow() {
        return this._statechange.getValue().state !== PopupWidgetStates.Close;
    }
    get isEnabled() {
        return this._statechange.getValue().state !== PopupWidgetStates.Disabled;
    }
    onWindowResize() {
        if (this.closeOnResize) {
            this.close();
        }
        else {
            this.setPosition();
        }
    }
    onPopState(event) {
        if (this.closeOnBrowserNav) {
            this.close();
        }
    }
    // component lifecycle events
    ngAfterViewInit() {
        this._viewInitialize = true;
        if (this.validate()) {
            if (this.appendTo && !this.modal) {
                this.appendChild(this.popup.nativeElement, this.appendTo);
            }
            else {
                document.body.appendChild(this.popup.nativeElement);
                if (this.appendTo) {
                    console.warn("[kaltura] -> Ignoring append to " + this.appendTo + " since popup is set to modal=true."); // keep warning
                }
            }
            if (this.fullScreen) {
                this.popup.nativeElement.style.width = '0px';
                this.popup.nativeElement.style.height = '0px';
            }
        }
    }
    ngOnDestroy() {
        if (this._targetRef) {
            this._targetRef.removeEventListener('click', this._toggleFunc);
            this._targetRef.removeEventListener('mouseover', this._openFunc);
            this._targetRef.removeEventListener('mouseout', this._closeFunc);
        }
        if (this._stateChangeSubscription) {
            this._stateChangeSubscription.unsubscribe();
        }
        this._statechange.complete();
        this.removeClickOutsideSupport();
        this.restorePageScroll(false);
        if (this.modal && this._modalOverlay) {
            document.body.removeChild(this._modalOverlay);
            this._modalOverlay = null;
        }
        if (this.appendTo && !this.modal) {
            this.removeChild(this.popup.nativeElement, this.appendTo);
        }
        else {
            if (this._viewInitialize) {
                document.body.removeChild(this.popup.nativeElement);
            }
        }
        window.removeEventListener('scroll', this._closeFunc);
    }
    // private methods
    addClickOutsideSupport() {
        if (this.closeOnClickOutside) {
            this.popup.nativeElement.addEventListener('mousedown', this.blockMouseDownHandler);
            if (this.targetRef) {
                this.targetRef.addEventListener('mousedown', this.blockMouseDownHandler);
            }
        }
    }
    blockMouseDownHandler(event) {
        event.stopPropagation();
    }
    removeClickOutsideSupport() {
        if (this.closeOnClickOutside) {
            this.popup.nativeElement.removeEventListener('mousedown', this.blockMouseDownHandler);
            if (this.targetRef) {
                this.targetRef.removeEventListener('mousedown', this.blockMouseDownHandler);
            }
        }
    }
    restorePageScroll(restoreScrollPosition = true) {
        if (this.preventPageScroll) {
            document.body.style.overflowY = 'auto';
            document.body.style.position = '';
            if (restoreScrollPosition) {
                window.scrollTo(0, this._saveScrollPosition);
            }
        }
    }
    validate() {
        let valid = typeof this.popupWidth !== 'undefined' || this.fullScreen;
        if (!valid) {
            this._statechange.next({ state: PopupWidgetStates.Disabled });
            throw "Popup widget error: missing required parameters. Verify popupWidth is defined.";
        }
        return valid;
    }
    appendChild(element, target) {
        if (this.isElement(target)) {
            target.appendChild(element);
        }
        else {
            throw 'Cannot append ' + target + ' to ' + element;
        }
    }
    removeChild(element, target) {
        if (this.isElement(target)) {
            target.removeChild(element);
        }
        else {
            throw 'Cannot remove ' + target + ' from ' + element;
        }
    }
    isElement(obj) {
        return (typeof HTMLElement === "object" ? obj instanceof HTMLElement :
            obj && typeof obj === "object" && obj !== null && obj.nodeType === 1 && typeof obj.nodeName === "string");
    }
    setPosition() {
        const popupHeight = this.popup.nativeElement.clientHeight;
        const popupWidth = this.popup.nativeElement.clientWidth;
        if (this.modal || this.slider) {
            this.popup.nativeElement.style.marginLeft = window.innerWidth / 2 - this.popupWidth / 2 + 'px';
            if (this.modal) {
                const modalMarginTop = (window.innerHeight / 2 -
                    popupHeight / 2);
                this.popup.nativeElement.style.marginTop = Math.round(modalMarginTop) + 'px';
                this.popup.nativeElement.style.opacity = 1;
            }
            return;
        }
        if (!this._targetRef)
            return;
        const popupBox = this.popup.nativeElement.getBoundingClientRect();
        const targetRefBox = this._targetRef.getBoundingClientRect();
        const parentTop = this.appendTo && !this.modal ? this.appendTo.getBoundingClientRect().top : 0;
        const parentLeft = this.appendTo && !this.modal ? this.appendTo.getBoundingClientRect().left : 0;
        let popupMarginTop;
        let popupMarginLeft;
        let popupLeftMargins = {};
        let popupTopMargins = {};
        popupTopMargins.top = (targetRefBox.top
            - parentTop
            - popupHeight
            + this.targetRef.offsetHeight
            - this.targetOffset['y']);
        popupTopMargins.bottom = (targetRefBox.top
            - parentTop
            + this.targetOffset['y']);
        popupTopMargins.center = (targetRefBox.top
            - parentTop
            - popupHeight / 2
            + this.targetRef.offsetHeight / 2
            + this.targetOffset['y']);
        popupLeftMargins.left = (targetRefBox.left
            - parentLeft
            - popupWidth
            + this.targetRef.clientWidth
            - this.targetOffset['x']);
        popupLeftMargins.right = (targetRefBox.left
            - parentLeft
            + this.targetOffset['x']);
        popupLeftMargins.center = (targetRefBox.left
            - parentLeft
            - popupWidth / 2
            + this.targetOffset['x']);
        popupMarginTop = this.placement.y ? popupTopMargins[this.placement.y] : popupTopMargins.bottom;
        popupMarginLeft = this.placement.x ? popupLeftMargins[this.placement.y] : popupLeftMargins.right;
        this.popup.nativeElement.style.marginTop = Math.round(popupMarginTop) + 'px';
        this.popup.nativeElement.style.marginLeft = Math.round(popupMarginLeft) + 'px';
        this.validatePosition(popupLeftMargins, popupTopMargins);
    }
    // validate popup widget is not outside of the viewport (+ gutter) and if it is, reposition it
    validatePosition(popupLeftMargins, popupTopMargins) {
        const popupHeight = this.popup.nativeElement.clientHeight;
        const popupWidth = this.popup.nativeElement.clientWidth;
        const popupBox = this.popup.nativeElement.getBoundingClientRect();
        const clientHeight = window.innerHeight;
        const clientWidth = window.innerWidth;
        let popupMarginTop;
        let popupMarginLeft;
        if (this.placement.y === 'top') {
            if (popupBox.top < WINDOW_GUTTER) {
                popupMarginTop = popupTopMargins.bottom;
            }
        }
        else if (this.placement.y === 'bottom') {
            if (popupBox.top + popupHeight > clientHeight - WINDOW_GUTTER && popupBox.top > clientHeight) {
                popupMarginTop = popupTopMargins.top;
            }
            else {
                popupMarginTop = popupTopMargins.bottom;
            }
        }
        else if (this.placement.y === 'center') {
            if (popupBox.top < WINDOW_GUTTER) {
                popupMarginTop = popupTopMargins.bottom;
            }
            else if (popupBox.top + popupHeight > clientHeight - WINDOW_GUTTER) {
                popupMarginTop = popupTopMargins.top;
            }
        }
        if (popupBox.left + popupWidth > clientWidth + WINDOW_GUTTER) {
            popupMarginLeft = popupLeftMargins.left;
        }
        else if (popupBox.left < WINDOW_GUTTER) {
            popupMarginLeft = popupLeftMargins.right;
        }
        this.popup.nativeElement.style.marginTop = Math.round(popupMarginTop) + 'px';
        this.popup.nativeElement.style.marginLeft = Math.round(popupMarginLeft) + 'px';
        this.popup.nativeElement.style.opacity = 1;
    }
};
PopupWidgetComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: Renderer2 }
];
__decorate([
    Input(),
    __metadata("design:type", Object)
], PopupWidgetComponent.prototype, "transparent", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], PopupWidgetComponent.prototype, "appendTo", void 0);
__decorate([
    Input(),
    __metadata("design:type", Number)
], PopupWidgetComponent.prototype, "popupWidth", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], PopupWidgetComponent.prototype, "popupHeight", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], PopupWidgetComponent.prototype, "showTooltip", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], PopupWidgetComponent.prototype, "preventPageScroll", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], PopupWidgetComponent.prototype, "modal", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], PopupWidgetComponent.prototype, "slider", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], PopupWidgetComponent.prototype, "fullScreen", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], PopupWidgetComponent.prototype, "closeBtn", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], PopupWidgetComponent.prototype, "closeBtnInside", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], PopupWidgetComponent.prototype, "closeOnClickOutside", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], PopupWidgetComponent.prototype, "closeOnResize", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], PopupWidgetComponent.prototype, "closeOnBrowserNav", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], PopupWidgetComponent.prototype, "targetOffset", void 0);
__decorate([
    Input(),
    __metadata("design:type", Array)
], PopupWidgetComponent.prototype, "childrenPopups", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], PopupWidgetComponent.prototype, "trigger", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], PopupWidgetComponent.prototype, "placement", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], PopupWidgetComponent.prototype, "closeOnScroll", void 0);
__decorate([
    ContentChild(TemplateRef, { static: true }),
    __metadata("design:type", TemplateRef)
], PopupWidgetComponent.prototype, "_template", void 0);
__decorate([
    HostBinding('class.opened'),
    __metadata("design:type", Object)
], PopupWidgetComponent.prototype, "opened", void 0);
__decorate([
    HostBinding('class.closed'),
    __metadata("design:type", Object)
], PopupWidgetComponent.prototype, "closed", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], PopupWidgetComponent.prototype, "targetRef", null);
__decorate([
    Input(),
    __metadata("design:type", PopupWidgetComponent),
    __metadata("design:paramtypes", [PopupWidgetComponent])
], PopupWidgetComponent.prototype, "parentPopup", null);
__decorate([
    Output(),
    __metadata("design:type", Object)
], PopupWidgetComponent.prototype, "onOpen", void 0);
__decorate([
    Output(),
    __metadata("design:type", Object)
], PopupWidgetComponent.prototype, "onClose", void 0);
__decorate([
    HostListener("window:resize", []),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", []),
    __metadata("design:returntype", void 0)
], PopupWidgetComponent.prototype, "onWindowResize", null);
__decorate([
    HostListener('window:popstate', ['$event']),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", void 0)
], PopupWidgetComponent.prototype, "onPopState", null);
PopupWidgetComponent = __decorate([
    Component({
        selector: 'kPopupWidget',
        template: "<div #container\n     class=\"kPopupWidget\"\n     [class.transparent]=\"transparent\"\n     [class.slider]=\"slider\"\n     [style.display]=\"(state$ | async)?.state !== 'close' ? 'block' : 'none'\"\n     [style.width]=\"popupWidth+'px'\"\n     [style.height]=\"_popupWidgetHeight\">\n    <div class=\"tooltipUp\" *ngIf=\"showTooltip\" [style.marginLeft]=\"popupWidth/2-12+'px'\"></div>\n    <i *ngIf=\"closeBtn\" class=\"kCloseBtn kIconclose_small\" [class.closeBtnInside]=\"closeBtnInside\" (click)=\"close()\"></i>\n    <div class=\"kPopupWidgetContent\" *ngIf=\"isShow\">\n        <ng-content *ngIf=\"!_template\"></ng-content>\n\t\t<ng-template *ngIf=\"_template\"\n\t\t\t[ngTemplateOutlet]=\"_template\">\n\t\t</ng-template>\n    </div>\n</div>\n",
        styles: [":host{position:absolute;left:0;top:0;transition:bottom .3s ease-in-out}:host.fullScreen{width:100%!important;height:100%!important;position:fixed}.kPopupWidget{background-color:#fff;border-radius:4px;box-shadow:0 16px 20px 0 rgba(0,0,0,.3)}.kPopupWidget.slider{border-bottom-right-radius:0;border-bottom-left-radius:0}.kPopupWidget.transparent{box-shadow:none;background:0}.kPopupWidget .kCloseBtn:not(.closeBtnInside){position:absolute;right:-118px;top:-62px;width:38px;height:38px;background-color:rgba(255,255,255,.2);border-radius:50%;text-align:center;padding-top:11px;padding-left:2px;box-sizing:border-box;color:#fff;cursor:pointer}.kPopupWidget .kCloseBtn:not(.closeBtnInside):hover{background-color:rgba(255,255,255,.4)}.kPopupWidget .kCloseBtn.closeBtnInside{font-size:14px;float:right;color:#999;margin-top:14px;margin-right:14px;cursor:pointer}.kPopupWidget .kCloseBtn.closeBtnInside:hover{color:#00a784}.kPopupWidget .tooltipUp{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAOCAYAAAA1+Nx+AAAAAXNSR0IArs4c6QAAAMpJREFUOBGtk0EOwiAQRcF0Z2JXspFTcAE9erkACXfADa50b3DGMAYjlGktSUNDhvfmlyLEguG9V86544ItQnKLEZxSslCfpJQXY8yNs3fHKcrwSSl1gGcE0cRN0k1AnSNca33ChkII1xjjA5Kce0lmE5SdExwF+I5CTpJmggI+lnAU0MhJ7nNnUhVw4FzJj2AJnCP5EmS4LQ+UIL25dfAfwT9wktckb8EW8JZEbgmvSQa8/mu+OcFqM/3WcBntAPA9LdSK165l5vMFmCyyP+zXS30AAAAASUVORK5CYII=);position:absolute;margin-top:-12px;width:24px;height:12px}"]
    }),
    __metadata("design:paramtypes", [ElementRef, Renderer2])
], PopupWidgetComponent);
export { PopupWidgetComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG9wdXAtd2lkZ2V0LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BrYWx0dXJhLW5nL2thbHR1cmEtdWkvIiwic291cmNlcyI6WyJsaWIvcG9wdXAtd2lkZ2V0L3BvcHVwLXdpZGdldC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFDTCxTQUFTLEVBQ1QsYUFBYSxFQUNiLFlBQVksRUFDWixTQUFTLEVBQ1QsS0FBSyxFQUNMLE1BQU0sRUFDTixVQUFVLEVBQ1YsWUFBWSxFQUNaLFdBQVcsRUFDWCxZQUFZLEVBQ1osU0FBUyxFQUNULFdBQVcsRUFDWixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFHdkQsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFDMUQsT0FBTywrQkFBK0IsQ0FBQztBQUN2QyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFFN0QsTUFBTSxDQUFDLE1BQU0saUJBQWlCLEdBQUc7SUFDN0IsTUFBTSxFQUFFLE1BQU07SUFDakIsYUFBYSxFQUFFLGFBQWE7SUFDekIsT0FBTyxFQUFFLE9BQU87SUFDbkIsVUFBVSxFQUFFLFVBQVU7Q0FDdEIsQ0FBQTtBQVlELE1BQU0sYUFBYSxHQUFHLEVBQUUsQ0FBQztBQU96QixJQUFhLG9CQUFvQixHQUFqQyxNQUFhLG9CQUFvQjtJQXFGN0IsWUFBbUIsS0FBaUIsRUFBVSxRQUFtQjtRQUE5QyxVQUFLLEdBQUwsS0FBSyxDQUFZO1FBQVUsYUFBUSxHQUFSLFFBQVEsQ0FBVztRQXBGM0QsZ0JBQVcsR0FBRyxLQUFLLENBQUM7UUFHakIsZ0JBQVcsR0FBb0IsTUFBTSxDQUFDO1FBQ3pDLGdCQUFXLEdBQVksS0FBSyxDQUFDO1FBQzdCLHNCQUFpQixHQUFZLEtBQUssQ0FBQztRQUNuQyxVQUFLLEdBQVksS0FBSyxDQUFDO1FBQ3ZCLFdBQU0s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RUFBRTs7cURBQW1DO0FBMEwvQztJQURDLFlBQVksQ0FBQyxlQUFlLEVBQUUsRUFBRSxDQUFDOzs7OzBEQU9qQztBQUdBO0lBREMsWUFBWSxDQUFDLGlCQUFpQixFQUFFLENBQUMsUUFBUSxDQUFDLENBQUM7Ozs7c0RBSzNDO0FBaFJVLG9CQUFvQjtJQUxoQyxTQUFTLENBQUM7UUFDUCxRQUFRLEVBQUUsY0FBYztRQUN4Qiw2dkJBQTRDOztLQUUvQyxDQUFDO3FDQXNGNEIsVUFBVSxFQUFvQixTQUFTO0dBckZ4RCxvQkFBb0IsQ0FvZ0JoQztTQXBnQlksb0JBQW9CIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQ29tcG9uZW50LFxuICBBZnRlclZpZXdJbml0LFxuICBFdmVudEVtaXR0ZXIsXG4gIE9uRGVzdHJveSxcbiAgSW5wdXQsXG4gIE91dHB1dCxcbiAgRWxlbWVudFJlZixcbiAgSG9zdExpc3RlbmVyLFxuICBUZW1wbGF0ZVJlZixcbiAgQ29udGVudENoaWxkLFxuICBSZW5kZXJlcjIsXG4gIEhvc3RCaW5kaW5nXG59IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5pbXBvcnQgeyBCZWhhdmlvclN1YmplY3QgfSBmcm9tICdyeGpzL0JlaGF2aW9yU3ViamVjdCc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcy9PYnNlcnZhYmxlJztcbmltcG9ydCB7IElTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzL1N1YnNjcmlwdGlvbic7XG5pbXBvcnQgeyBQb3B1cFdpZGdldExheW91dCB9IGZyb20gJy4vcG9wdXAtd2lkZ2V0LWxheW91dCc7XG5pbXBvcnQgJ3J4anMvYWRkL29ic2VydmFibGUvZnJvbUV2ZW50JztcbmltcG9ydCB7IGNhbmNlbE9uRGVzdHJveSB9IGZyb20gJ0BrYWx0dXJhLW5nL2thbHR1cmEtY29tbW9uJztcblxuZXhwb3J0IGNvbnN0IFBvcHVwV2lkZ2V0U3RhdGVzID0ge1xuICAgIFwiT3BlblwiOiBcIm9wZW5cIixcblx0XCJCZWZvcmVDbG9zZVwiOiBcImJlZm9yZUNsb3NlXCIsXG4gICAgXCJDbG9zZVwiOiBcImNsb3NlXCIsXG5cdFwiRGlzYWJsZWRcIjogXCJkaXNhYmxlZFwiXG59XG5leHBvcnQgdHlwZSBwb3B1cFN0YXR1cyA9IHtcblx0c3RhdGU6IHN0cmluZyxcblx0Y29udGV4dD86IGFueSxcblx0cmVhc29uPzogc3RyaW5nXG59XG5cbmV4cG9ydCB0eXBlIFBvcHVwV2lkZ2V0WFBvc2l0aW9ucyA9ICdsZWZ0JyB8ICdyaWdodCcgfCAnY2VudGVyJztcbmV4cG9ydCB0eXBlIFBvcHVwV2lkZ2V0WVBvc2l0aW9ucyA9ICd0b3AnIHwgJ2JvdHRvbScgfCAnY2VudGVyJztcbnR5cGUgUG9wdXBXaWRnZXRYTWFyZ2lucyA9IHtsZWZ0PzogbnVtYmVyLCByaWdodD86IG51bWJlciwgY2VudGVyPzogbnVtYmVyfVxudHlwZSBQb3B1cFdpZGdldFlNYXJnaW5zID0ge3RvcD86IG51bWJlciwgYm90dG9tPzogbnVtYmVyLCBjZW50ZXI/OiBudW1iZXJ9XG5cbmNvbnN0IFdJTkRPV19HVVRURVIgPSAxNjtcblxuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6ICdrUG9wdXBXaWRnZXQnLFxuICAgIHRlbXBsYXRlVXJsOiAnLi9wb3B1cC13aWRnZXQuY29tcG9uZW50Lmh0bWwnLFxuICAgIHN0eWxlVXJsczogWycuL3BvcHVwLXdpZGdldC5jb21wb25lbnQuc2NzcyddXG59KVxuZXhwb3J0IGNsYXNzIFBvcHVwV2lkZ2V0Q29tcG9uZW50IGltcGxlbWVudHMgQWZ0ZXJWaWV3SW5pdCwgT25EZXN0cm95e1xuXHRASW5wdXQoKSB0cmFuc3BhcmVudCA9IGZhbHNlO1xuXHRASW5wdXQoKSBhcHBlbmRUbzogYW55O1xuXHRASW5wdXQoKSBwb3B1cFdpZHRoOiBudW1iZXI7XG4gICAgQElucHV0KCkgcG9wdXBIZWlnaHQ6IG51bWJlciB8ICdhdXRvJyA9ICdhdXRvJztcblx0QElucHV0KCkgc2hvd1Rvb2x0aXA6IGJvb2xlYW4gPSBmYWxzZTtcblx0QElucHV0KCkgcHJldmVudFBhZ2VTY3JvbGw6IGJvb2xlYW4gPSBmYWxzZTtcblx0QElucHV0KCkgbW9kYWw6IGJvb2xlYW4gPSBmYWxzZTtcblx0QElucHV0KCkgc2xpZGVyOiBib29sZWFuID0gZmFsc2U7XG5cdEBJbnB1dCgpIGZ1bGxTY3JlZW46IGJvb2xlYW4gPSBmYWxzZTtcblx0QElucHV0KCkgY2xvc2VCdG46IGJvb2xlYW4gPSB0cnVlO1xuXHRASW5wdXQoKSBjbG9zZUJ0bkluc2lkZTogYm9vbGVhbiA9IGZhbHNlO1xuXHRASW5wdXQoKSBjbG9zZU9uQ2xpY2tPdXRzaWRlOiBib29sZWFuID0gdHJ1ZTtcblx0QElucHV0KCkgY2xvc2VPblJlc2l6ZTogYm9vbGVhbiA9IGZhbHNlO1xuXHRASW5wdXQoKSBjbG9zZU9uQnJvd3Nlck5hdjogYm9vbGVhbiA9IHRydWU7XG5cdEBJbnB1dCgpIHRhcmdldE9mZnNldDogYW55ID0geyd4JzowLCAneSc6IDB9O1xuXHRASW5wdXQoKSBjaGlsZHJlblBvcHVwczogUG9wdXBXaWRnZXRDb21wb25lbnRbXSA9IFtdO1xuXHRASW5wdXQoKSB0cmlnZ2VyOiAnY2xpY2snIHwgJ2hvdmVyJyA9ICdjbGljayc7XG5cdEBJbnB1dCgpIHBsYWNlbWVudDoge3g6IFBvcHVwV2lkZ2V0WFBvc2l0aW9ucywgeTogUG9wdXBXaWRnZXRZUG9zaXRpb25zfSA9IHt4OiAncmlnaHQnLCB5OiAnYm90dG9tJ31cbiAgQElucHV0KCkgY2xvc2VPblNjcm9sbDogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIEBDb250ZW50Q2hpbGQoVGVtcGxhdGVSZWYsIHsgc3RhdGljOiB0cnVlIH0pIHB1YmxpYyBfdGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47XG4gIEBIb3N0QmluZGluZygnY2xhc3Mub3BlbmVkJykgb3BlbmVkID0gZmFsc2U7XG4gIEBIb3N0QmluZGluZygnY2xhc3MuY2xvc2VkJykgY2xvc2VkID0gZmFsc2U7XG5cblxuXHRwcml2YXRlIHJlYWRvbmx5IF90b2dnbGVGdW5jID0gdGhpcy50b2dnbGUuYmluZCh0aGlzKTtcblx0cHJpdmF0ZSByZWFkb25seSBfb3BlbkZ1bmMgPSB0aGlzLm9wZW4uYmluZCh0aGlzKTtcblx0cHJpdmF0ZSByZWFkb25seSBfY2xvc2VGdW5jID0gdGhpcy5jbG9zZS5iaW5kKHRoaXMpO1xuXG4gICAgcHJpdmF0ZSBfdmlld0luaXRpYWxpemUgPSBmYWxzZTtcblxuXHRASW5wdXQoKSBzZXQgdGFyZ2V0UmVmKHRhcmdldFJlZjogYW55KSB7XG5cdFx0aWYgKHRoaXMudHJpZ2dlciA9PT0gJ2NsaWNrJykge1xuXHRcdFx0aWYgKHRoaXMuX3RhcmdldFJlZikge1xuXHRcdFx0XHR0aGlzLl90YXJnZXRSZWYucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl90b2dnbGVGdW5jKTtcblx0XHRcdH1cblx0XHRcdHRoaXMuX3RhcmdldFJlZiA9IHRhcmdldFJlZjtcblx0XHRcdGlmICh0aGlzLl90YXJnZXRSZWYpIHtcblx0XHRcdFx0dGhpcy5fdGFyZ2V0UmVmLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5fdG9nZ2xlRnVuYyk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGVsc2UgaWYgKHRoaXMudHJpZ2dlciA9PT0gJ2hvdmVyJykge1xuXHRcdFx0aWYgKHRoaXMuX3RhcmdldFJlZikge1xuXHRcdFx0XHR0aGlzLl90YXJnZXRSZWYucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywgdGhpcy5fb3BlbkZ1bmMpO1xuXHRcdFx0XHR0aGlzLl90YXJnZXRSZWYucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2VvdXQnLCB0aGlzLl9jbG9zZUZ1bmMpO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy5fdGFyZ2V0UmVmID0gdGFyZ2V0UmVmO1xuXHRcdFx0aWYgKHRoaXMuX3RhcmdldFJlZikge1xuXHRcdFx0XHR0aGlzLl90YXJnZXRSZWYuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywgdGhpcy5fb3BlbkZ1bmMpO1xuXHRcdFx0XHR0aGlzLl90YXJnZXRSZWYuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdXQnLCB0aGlzLl9jbG9zZUZ1bmMpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRnZXQgdGFyZ2V0UmVmKCk6IGFueSB7IHJldHVybiB0aGlzLl90YXJnZXRSZWY7IH1cblxuXHRASW5wdXQoKSBzZXQgcGFyZW50UG9wdXAocGFyZW50UG9wdXA6IFBvcHVwV2lkZ2V0Q29tcG9uZW50KXtcblx0XHR0aGlzLl9wYXJlbnRQb3B1cCA9IHBhcmVudFBvcHVwO1xuXHRcdGlmICh0aGlzLl9zdGF0ZUNoYW5nZVN1YnNjcmlwdGlvbil7XG5cdFx0XHR0aGlzLl9zdGF0ZUNoYW5nZVN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuXHRcdFx0dGhpcy5fc3RhdGVDaGFuZ2VTdWJzY3JpcHRpb24gPSBudWxsO1xuXHRcdH1cblx0XHRpZiAodGhpcy5fcGFyZW50UG9wdXApIHtcblx0XHRcdHRoaXMuX3N0YXRlQ2hhbmdlU3Vic2NyaXB0aW9uID0gdGhpcy5fcGFyZW50UG9wdXAuc3RhdGUkLnN1YnNjcmliZShldmVudCA9PiB7XG5cdFx0XHRcdGlmIChldmVudC5zdGF0ZSA9PT0gUG9wdXBXaWRnZXRTdGF0ZXMuQ2xvc2UpIHtcblx0XHRcdFx0XHR0aGlzLmNsb3NlKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXHRnZXQgcGFyZW50UG9wdXAoKTogUG9wdXBXaWRnZXRDb21wb25lbnQgeyByZXR1cm4gdGhpcy5fcGFyZW50UG9wdXA7IH1cblxuXHRAT3V0cHV0KCkgb25PcGVuID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG4gICAgQE91dHB1dCgpIG9uQ2xvc2UgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuXHRwcml2YXRlIF90YXJnZXRSZWY6IGFueTtcbiAgICBwcml2YXRlIF9zYXZlU2Nyb2xsUG9zaXRpb246IG51bWJlcjtcblx0cHVibGljIF9wb3B1cFdpZGdldEhlaWdodDogc3RyaW5nO1xuICAgIHByaXZhdGUgX21vZGFsT3ZlcmxheTogYW55O1xuXHRwcml2YXRlIF9wYXJlbnRQb3B1cDogUG9wdXBXaWRnZXRDb21wb25lbnQ7XG5cdHByaXZhdGUgX3N0YXRlQ2hhbmdlU3Vic2NyaXB0aW9uOiBJU3Vic2NyaXB0aW9uID0gbnVsbDtcblx0cHJpdmF0ZSBfc3RhdGVjaGFuZ2U6IEJlaGF2aW9yU3ViamVjdDxwb3B1cFN0YXR1cz4gPSBuZXcgQmVoYXZpb3JTdWJqZWN0PHBvcHVwU3RhdHVzPih7c3RhdGU6ICcnfSk7XG5cblx0cHVibGljIHN0YXRlJDogT2JzZXJ2YWJsZTxwb3B1cFN0YXR1cz4gPSB0aGlzLl9zdGF0ZWNoYW5nZS5hc09ic2VydmFibGUoKTtcblxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBwb3B1cDogRWxlbWVudFJlZiwgcHJpdmF0ZSByZW5kZXJlcjogUmVuZGVyZXIyKSB7XG5cdCAgICB0aGlzLl9zdGF0ZWNoYW5nZS5uZXh0KHtzdGF0ZTogUG9wdXBXaWRnZXRTdGF0ZXMuQ2xvc2V9KTtcbiAgICAgIHRoaXMuc3RhdGUkXG4gICAgICAgIC5waXBlKGNhbmNlbE9uRGVzdHJveSh0aGlzKSlcbiAgICAgICAgLnN1YnNjcmliZSgoeyBzdGF0ZSB9KSA9PiB7XG4gICAgICAgICAgdGhpcy5jbG9zZWQgPSBzdGF0ZSA9PT0gUG9wdXBXaWRnZXRTdGF0ZXMuQ2xvc2U7XG4gICAgICAgICAgdGhpcy5vcGVuZWQgPSBzdGF0ZSA9PT0gUG9wdXBXaWRnZXRTdGF0ZXMuT3BlbjtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gcHVibGljIEFQSSBtZXRob2RzXG4gICAgb3Blbigpe1xuXHRcdGlmICh0aGlzLmlzRW5hYmxlZCAmJiB0aGlzLnZhbGlkYXRlKCkpIHtcblx0ICAgICAgICAvLyBoYW5kbGUgYXV0byBoZWlnaHRcblx0XHRcdGlmICghdGhpcy5wb3B1cEhlaWdodCAgfHwgdGhpcy5wb3B1cEhlaWdodCA9PT0gJ2F1dG8nKXtcblx0XHRcdFx0aWYgKHRoaXMuc2xpZGVyKSB7XG5cdFx0XHRcdFx0dGhpcy5fcG9wdXBXaWRnZXRIZWlnaHQgPSAnY2FsYygxMDB2aCAtIDgwcHgpJztcblx0XHRcdFx0fWVsc2Uge1xuXHRcdFx0XHRcdHRoaXMuX3BvcHVwV2lkZ2V0SGVpZ2h0ID0gJ2F1dG8nO1xuXHRcdFx0XHR9XG5cdCAgICAgICAgfSBlbHNlXG5cdCAgICAgICAge1xuXHRcdCAgICAgICAgdGhpcy5fcG9wdXBXaWRnZXRIZWlnaHQgPSB0aGlzLnBvcHVwSGVpZ2h0ICsgXCJweFwiO1xuXHQgICAgICAgIH1cblx0XHRcdHRoaXMuX3NhdmVTY3JvbGxQb3NpdGlvbiA9IHdpbmRvdy5wYWdlWU9mZnNldCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wO1xuICAgICAgICAgICAgLy8gc2V0IGxvY2F0aW9uIGFjY29yZGluZyB0byB0YXJnZXRSZWZcblx0ICAgICAgICBjb25zdCBwYXJlbnRMZWZ0ID0gdGhpcy5hcHBlbmRUbyAmJiAhdGhpcy5tb2RhbCA/IHRoaXMuYXBwZW5kVG8uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCA6IDA7XG5cdCAgICAgICAgY29uc3QgcGFyZW50VG9wID0gdGhpcy5hcHBlbmRUbyAmJiAhdGhpcy5tb2RhbCA/IHRoaXMuYXBwZW5kVG8uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wIDogMDtcblx0ICAgICAgICAvLyBjZW50ZXIgb24gc2NyZWVuIGlmIG5vIHRhcmdldFJlZiB3YXMgZGVmaW5lZFxuXHQgICAgICAgIGlmICghdGhpcy5fdGFyZ2V0UmVmKXtcblx0ICAgICAgICBcdGlmICh0aGlzLmZ1bGxTY3JlZW4pe1xuXHQgICAgICAgIFx0XHR0aGlzLm1vZGFsID0gZmFsc2U7XG5cdCAgICAgICAgXHRcdHRoaXMucHJldmVudFBhZ2VTY3JvbGwgPSB0cnVlO1xuXHRcdFx0ICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMucG9wdXAubmF0aXZlRWxlbWVudCwgJ2Z1bGxTY3JlZW4nKTtcblx0XHQgICAgICAgIH1lbHNlIHtcblx0XHRcdCAgICAgICAgdGhpcy5wb3B1cC5uYXRpdmVFbGVtZW50LnN0eWxlLm1hcmdpbkxlZnQgPSB3aW5kb3cuaW5uZXJXaWR0aCAvIDIgLSB0aGlzLnBvcHVwV2lkdGggLyAyICsgJ3B4Jztcblx0XHRcdCAgICAgICAgaWYgKHRoaXMuc2xpZGVyKSB7XG5cdFx0XHRcdCAgICAgICAgd2luZG93LnNjcm9sbFRvKDAsIDApO1xuXHRcdFx0XHQgICAgICAgIHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5zdHlsZS50b3AgPSBcImF1dG9cIjtcblx0XHRcdFx0ICAgICAgICB0aGlzLmNsb3NlQnRuID0gZmFsc2U7XG5cdFx0XHRcdCAgICAgICAgdGhpcy5wcmV2ZW50UGFnZVNjcm9sbCA9IHRydWU7XG5cdFx0XHRcdCAgICAgICAgdGhpcy5wb3B1cC5uYXRpdmVFbGVtZW50LnN0eWxlLmJvdHRvbSA9IHRoaXMucG9wdXBIZWlnaHQgIT09ICdhdXRvJyA/IHRoaXMucG9wdXBIZWlnaHQgKiAtMSArIFwicHhcIiA6IFwiLTEwMDBweFwiO1xuXHRcdFx0XHQgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdCAgICAgICAgdGhpcy5wb3B1cC5uYXRpdmVFbGVtZW50LnN0eWxlLmJvdHRvbSA9IDAgKyBcInB4XCI7IC8vIHVzZSB0aW1lb3V0IHRvIGludm9rZSBhbmltYXRpb25cblx0XHRcdFx0ICAgICAgICB9LCAwKTtcblx0XHRcdCAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBtYXJnaW5Ub3AgPSAod2luZG93LmlubmVySGVpZ2h0IC8gMiAtIDEwMCAvIDIpO1xuXHRcdFx0XHQgICAgICAgIHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5zdHlsZS5tYXJnaW5Ub3AgPSBtYXJnaW5Ub3AgKyAncHgnO1xuXHRcdFx0XHQgICAgICAgIHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5zdHlsZS5wb3NpdGlvbiA9IFwiZml4ZWRcIjtcblx0XHRcdCAgICAgICAgfVxuXHRcdCAgICAgICAgfVxuXHQgICAgICAgIH1lbHNle1xuXHRcdCAgICAgICAgdGhpcy5wb3B1cC5uYXRpdmVFbGVtZW50LnN0eWxlLm1hcmdpbkxlZnQgPSB0aGlzLl90YXJnZXRSZWYuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCAtIHBhcmVudExlZnQgKyB0aGlzLnRhcmdldE9mZnNldFsneCddICsgJ3B4Jztcblx0XHQgICAgICAgIHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5zdHlsZS5tYXJnaW5Ub3AgPSB0aGlzLl90YXJnZXRSZWYuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wIC0gcGFyZW50VG9wICsgdGhpcy50YXJnZXRPZmZzZXRbJ3knXSArICdweCc7XG5cdFx0ICAgICAgICB0aGlzLnBvcHVwLm5hdGl2ZUVsZW1lbnQuc3R5bGUucG9zaXRpb24gPSBcImFic29sdXRlXCI7XG5cdCAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5wb3B1cC5uYXRpdmVFbGVtZW50LnN0eWxlLnpJbmRleCA9IFBvcHVwV2lkZ2V0TGF5b3V0LmdldFBvcHVwWmluZGV4KHRoaXMuZnVsbFNjcmVlbik7XG5cbiAgICAgICAgICAgIC8vIGhhbmRsZSBtb2RhbFxuXHQgICAgICAgIGlmICghdGhpcy5fbW9kYWxPdmVybGF5KSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudHJpZ2dlciAhPT0gJ2hvdmVyJykge3RoaXMuX21vZGFsT3ZlcmxheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLm1vZGFsIHx8IHRoaXMuc2xpZGVyKSB7XG5cdCAgICAgICAgICAgICAgICB0aGlzLl9tb2RhbE92ZXJsYXkuY2xhc3NOYW1lID0gXCJrUG9wdXBXaWRnZXRNb2RhbE92ZXJsYXlcIjtcbiAgICAgICAgICAgICAgICB9ZWxzZXtcblx0ICAgICAgICAgICAgICAgIHRoaXMuX21vZGFsT3ZlcmxheS5jbGFzc05hbWUgPSBcImtQb3B1cFdpZGdldE1vZGFsT3ZlcmxheSBrVHJhbnNwYXJlbnRcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5fbW9kYWxPdmVybGF5LnN0eWxlLnpJbmRleCA9IHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5zdHlsZS56SW5kZXggLSAxO1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5zbGlkZXIgJiYgdGhpcy5jbG9zZU9uQ2xpY2tPdXRzaWRlKSB7XG5cdCAgICAgICAgICAgICAgICB0aGlzLl9tb2RhbE92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZlbnQ6IGFueSkgPT4ge1xuXHRcdCAgICAgICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHQgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuXHQgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5hcHBlbmRUbyl7XG5cdFx0XHQgICAgICAgIHRoaXMuYXBwZW5kQ2hpbGQodGhpcy5fbW9kYWxPdmVybGF5LCB0aGlzLmFwcGVuZFRvKTtcblx0XHQgICAgICAgIH1lbHNlIHsgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5fbW9kYWxPdmVybGF5KTt9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubW9kYWwgfHwgdGhpcy5zbGlkZXIpIHtcblx0ICAgICAgICAgICAgICAgIFBvcHVwV2lkZ2V0TGF5b3V0LmluY3JlYXNlTW9kYWxDb3VudCgpO1xuXHQgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gcHJldmVudCBwYWdlIHNjcm9sbFxuXHQgICAgICAgIGlmICh0aGlzLnByZXZlbnRQYWdlU2Nyb2xsKXtcblx0ICAgICAgICBcdGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3dZID0gJ2hpZGRlbic7XG5cdCAgICAgICAgXHRkb2N1bWVudC5ib2R5LnN0eWxlLnBvc2l0aW9uID0gJ2ZpeGVkJztcblx0ICAgICAgICB9XG5cbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCk9Pntcblx0ICAgICAgICAgICAgdGhpcy5hZGRDbGlja091dHNpZGVTdXBwb3J0KCk7XG4gICAgICAgICAgICB9LDApO1xuXG4gICAgICAgICAgICB0aGlzLm9uT3Blbi5lbWl0KCk7IC8vIGRpc3BhdGNoIG9uT3BlbiBldmVudCAoQVBJKVxuICAgICAgICAgICAgdGhpcy5fc3RhdGVjaGFuZ2UubmV4dCh7c3RhdGU6IFBvcHVwV2lkZ2V0U3RhdGVzLk9wZW59KTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuY2xvc2VPblNjcm9sbCAmJiB0aGlzLmlzU2hvdykge1xuICAgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdGhpcy5fY2xvc2VGdW5jKTtcbiAgICAgICAgICAgIH1cblxuXHRcdH1cblx0ICAgIGlmICghdGhpcy5zbGlkZXIgJiYgIXRoaXMuZnVsbFNjcmVlbiAmJiB0aGlzLnBvcHVwLm5hdGl2ZUVsZW1lbnQpIHtcblx0XHQgICAgdGhpcy5wb3B1cC5uYXRpdmVFbGVtZW50LnN0eWxlLm9wYWNpdHkgPSAwO1xuXHQgICAgfVxuXHQgICAgLy8gYXV0byBwb3NpdGlvbmluZyBuZWVkIGZpcnN0IHRoZSBkb20gdG8gcmVuZGVyXG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHR0aGlzLnNldFBvc2l0aW9uKCk7XG5cdFx0fSwgMCk7XG4gICAgfVxuXG4gICAgY2xvc2UoY29udGV4dDogYW55ID0gbnVsbCwgcmVhc29uOiBzdHJpbmcgPSBudWxsKXtcbiAgICAgICAgaWYgKHRoaXMuaXNFbmFibGVkICYmIHRoaXMuaXNTaG93KSB7XG4gICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHRoaXMuX2Nsb3NlRnVuYyk7XG5cdCAgICAgICAgaWYgKHRoaXMuZnVsbFNjcmVlbil7XG5cdFx0ICAgICAgICB0aGlzLnJlbmRlcmVyLnJlbW92ZUNsYXNzKHRoaXMucG9wdXAubmF0aXZlRWxlbWVudCwgJ2Z1bGxTY3JlZW4nKTtcblx0ICAgICAgICB9XG5cdFx0XHQvLyBhbGxvdyBjYW5jZWxsaW5nIHRoZSBjbG9zZSBvcGVyYXRpb25cblx0ICAgICAgICBsZXQgYmVmb3JlQ2xvc2VDb250ZXh0ID0ge1wiYWxsb3dDbG9zZVwiOiB0cnVlfTtcblx0ICAgICAgICB0aGlzLl9zdGF0ZWNoYW5nZS5uZXh0KHtzdGF0ZTogUG9wdXBXaWRnZXRTdGF0ZXMuQmVmb3JlQ2xvc2UsIGNvbnRleHQ6IGJlZm9yZUNsb3NlQ29udGV4dH0pO1xuXHQgICAgICAgIGlmIChiZWZvcmVDbG9zZUNvbnRleHRbJ2FsbG93Q2xvc2UnXSkge1xuXHRcdCAgICAgICAgLy8gY2xvc2UgY2hpbGRyZW4gcG9wdXBzIGlmIGV4aXN0XG5cdFx0ICAgICAgICBpZiAodGhpcy5jaGlsZHJlblBvcHVwcy5sZW5ndGgpIHtcblx0XHRcdCAgICAgICAgdGhpcy5jaGlsZHJlblBvcHVwcy5mb3JFYWNoKChwb3B1cDogUG9wdXBXaWRnZXRDb21wb25lbnQpID0+IHtcblx0XHRcdFx0ICAgICAgICBwb3B1cC5jbG9zZSgpO1xuXHRcdFx0ICAgICAgICB9KTtcblx0XHQgICAgICAgIH1cblx0XHQgICAgICAgIHRoaXMucmVtb3ZlQ2xpY2tPdXRzaWRlU3VwcG9ydCgpO1xuXHRcdCAgICAgICAgdGhpcy5yZXN0b3JlUGFnZVNjcm9sbCh0cnVlKTtcblx0XHQgICAgICAgIHRoaXMub25DbG9zZS5lbWl0KCk7IC8vIGRpc3BhdGNoIG9uQ2xvc2UgZXZlbnQgKEFQSSlcblx0XHQgICAgICAgIGxldCB0aW1lb3V0ID0gMDtcblx0XHQgICAgICAgIGlmICh0aGlzLnNsaWRlcil7XG5cdFx0XHQgICAgICAgIHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5zdHlsZS5ib3R0b20gPSB0aGlzLnBvcHVwSGVpZ2h0IT09ICdhdXRvJyA/ICB0aGlzLnBvcHVwSGVpZ2h0ICogLTEgK1wicHhcIiA6ICBcIi0xMDAwcHhcIjtcblx0XHRcdCAgICAgICAgdGltZW91dCA9IDMwMDtcblx0XHQgICAgICAgIH1cblx0XHQgICAgICAgIGlmICh0aGlzLm1vZGFsICYmICF0aGlzLnNsaWRlcikge1xuXHRcdFx0ICAgICAgICBQb3B1cFdpZGdldExheW91dC5kZWNyZWFzZU1vZGFsQ291bnQoKTtcblx0XHQgICAgICAgIH1cblx0XHQgICAgICAgIHNldFRpbWVvdXQoKCk9Pntcblx0XHRcdCAgICAgICAgLy8gcmVtb3ZlIG1vZGFsXG5cdFx0XHQgICAgICAgIGlmICh0aGlzLl9tb2RhbE92ZXJsYXkpIHtcblx0XHRcdFx0ICAgICAgICBpZiAodGhpcy5hcHBlbmRUbyl7XG5cdFx0XHRcdFx0ICAgICAgICB0aGlzLnJlbW92ZUNoaWxkKHRoaXMuX21vZGFsT3ZlcmxheSwgdGhpcy5hcHBlbmRUbyk7XG5cdFx0XHRcdCAgICAgICAgfWVsc2Uge1xuXHRcdFx0XHRcdCAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCh0aGlzLl9tb2RhbE92ZXJsYXkpO1xuXHRcdFx0XHQgICAgICAgIH1cblx0XHRcdFx0ICAgICAgICB0aGlzLl9tb2RhbE92ZXJsYXkgPSBudWxsO1xuXHRcdFx0ICAgICAgICB9XG5cdFx0XHQgICAgICAgIGlmICh0aGlzLnNsaWRlcikge1xuXHRcdFx0XHQgICAgICAgIFBvcHVwV2lkZ2V0TGF5b3V0LmRlY3JlYXNlTW9kYWxDb3VudCgpO1xuXHRcdFx0ICAgICAgICB9XG5cdFx0XHQgICAgICAgIHRoaXMuX3N0YXRlY2hhbmdlLm5leHQoe3N0YXRlOiBQb3B1cFdpZGdldFN0YXRlcy5DbG9zZSwgY29udGV4dDogY29udGV4dCwgcmVhc29uOiByZWFzb259KTsgLy8gdXNlIHRpbWVvdXQgdG8gcHJldmVudCB2YWx1ZUNoYW5nZUFmdGVyQ2hlY2tlZCBlcnJvclxuXHRcdCAgICAgICAgfSx0aW1lb3V0KTtcblx0ICAgICAgICB9XG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIHRvZ2dsZSgpe1xuICAgICAgICBpZiAodGhpcy5pc0VuYWJsZWQpIHtcbiAgICAgICAgICAgIHRoaXMuaXNTaG93ID8gdGhpcy5jbG9zZSgpIDogdGhpcy5vcGVuKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXQgaXNTaG93KCk6IGJvb2xlYW4ge1xuICAgIFx0cmV0dXJuIHRoaXMuX3N0YXRlY2hhbmdlLmdldFZhbHVlKCkuc3RhdGUgIT09IFBvcHVwV2lkZ2V0U3RhdGVzLkNsb3NlO1xuICAgIH1cblxuICAgIGdldCBpc0VuYWJsZWQoKTogYm9vbGVhbiB7XG4gICAgXHRyZXR1cm4gdGhpcy5fc3RhdGVjaGFuZ2UuZ2V0VmFsdWUoKS5zdGF0ZSAhPT0gUG9wdXBXaWRnZXRTdGF0ZXMuRGlzYWJsZWQ7XG4gICAgfVxuXG5cblxuXG5cdEBIb3N0TGlzdGVuZXIoXCJ3aW5kb3c6cmVzaXplXCIsIFtdKVxuXHRvbldpbmRvd1Jlc2l6ZSgpIHtcblx0XHRpZiAodGhpcy5jbG9zZU9uUmVzaXplKSB7XG5cdFx0XHR0aGlzLmNsb3NlKCk7XG5cdFx0fWVsc2V7XG5cdFx0XHR0aGlzLnNldFBvc2l0aW9uKCk7XG5cdFx0fVxuXHR9XG5cbiAgQEhvc3RMaXN0ZW5lcignd2luZG93OnBvcHN0YXRlJywgWyckZXZlbnQnXSlcbiAgb25Qb3BTdGF0ZShldmVudCkge1xuICAgIGlmICh0aGlzLmNsb3NlT25Ccm93c2VyTmF2KSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgICAvLyBjb21wb25lbnQgbGlmZWN5Y2xlIGV2ZW50c1xuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcblx0XHR0aGlzLl92aWV3SW5pdGlhbGl6ZSA9IHRydWU7XG5cbiAgICAgICAgaWYgKHRoaXMudmFsaWRhdGUoKSkge1xuXHRcdFx0aWYgKHRoaXMuYXBwZW5kVG8gJiYgIXRoaXMubW9kYWwpe1xuXHRcdFx0XHR0aGlzLmFwcGVuZENoaWxkKHRoaXMucG9wdXAubmF0aXZlRWxlbWVudCwgdGhpcy5hcHBlbmRUbyk7XG5cdCAgICAgICAgfWVsc2Uge1xuXHRcdCAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLnBvcHVwLm5hdGl2ZUVsZW1lbnQpO1xuXHRcdCAgICAgICAgaWYgKHRoaXMuYXBwZW5kVG8pe1xuXHRcdCAgICAgICAgXHRjb25zb2xlLndhcm4oXCJba2FsdHVyYV0gLT4gSWdub3JpbmcgYXBwZW5kIHRvIFwiICsgdGhpcy5hcHBlbmRUbyArIFwiIHNpbmNlIHBvcHVwIGlzIHNldCB0byBtb2RhbD10cnVlLlwiKTsgLy8ga2VlcCB3YXJuaW5nXG5cdFx0ICAgICAgICB9XG5cdFx0XHR9XG5cdCAgICAgICAgaWYgKHRoaXMuZnVsbFNjcmVlbil7XG5cdFx0ICAgICAgICB0aGlzLnBvcHVwLm5hdGl2ZUVsZW1lbnQuc3R5bGUud2lkdGggPSAnMHB4Jztcblx0XHQgICAgICAgIHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5zdHlsZS5oZWlnaHQgPSAnMHB4Jztcblx0ICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBuZ09uRGVzdHJveSgpe1xuXG4gICAgXHRpZiAodGhpcy5fdGFyZ2V0UmVmKVxuICAgIFx0e1xuXHRcdHRoaXMuX3RhcmdldFJlZi5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX3RvZ2dsZUZ1bmMpO1xuXHRcdHRoaXMuX3RhcmdldFJlZi5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCB0aGlzLl9vcGVuRnVuYyk7XG5cdFx0dGhpcy5fdGFyZ2V0UmVmLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlb3V0JywgdGhpcy5fY2xvc2VGdW5jKTtcbiAgICBcdH1cblxuICAgICAgICBpZiAodGhpcy5fc3RhdGVDaGFuZ2VTdWJzY3JpcHRpb24pe1xuICAgICAgICAgICAgdGhpcy5fc3RhdGVDaGFuZ2VTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgfVxuXHQgICAgdGhpcy5fc3RhdGVjaGFuZ2UuY29tcGxldGUoKTtcbiAgICAgICAgdGhpcy5yZW1vdmVDbGlja091dHNpZGVTdXBwb3J0KCk7XG4gICAgICAgIHRoaXMucmVzdG9yZVBhZ2VTY3JvbGwoZmFsc2UpO1xuXHQgICAgaWYgKHRoaXMubW9kYWwgJiYgdGhpcy5fbW9kYWxPdmVybGF5KSB7XG5cdFx0ICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQodGhpcy5fbW9kYWxPdmVybGF5KTtcblx0XHQgICAgdGhpcy5fbW9kYWxPdmVybGF5ID0gbnVsbDtcblx0ICAgIH1cblx0ICAgIGlmICh0aGlzLmFwcGVuZFRvICYmICF0aGlzLm1vZGFsKXtcblx0XHQgICAgdGhpcy5yZW1vdmVDaGlsZCh0aGlzLnBvcHVwLm5hdGl2ZUVsZW1lbnQsIHRoaXMuYXBwZW5kVG8pO1xuXHQgICAgfWVsc2Uge1xuXHQgICAgXHRpZiAodGhpcy5fdmlld0luaXRpYWxpemUpIHtcbiAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHRoaXMucG9wdXAubmF0aXZlRWxlbWVudCk7XG5cdFx0XHRcdH1cblx0ICAgIH1cblxuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHRoaXMuX2Nsb3NlRnVuYyk7XG4gICAgfVxuXG4gICAgLy8gcHJpdmF0ZSBtZXRob2RzXG5cbiAgICBwcml2YXRlIGFkZENsaWNrT3V0c2lkZVN1cHBvcnQoKXtcbiAgICAgICAgaWYgKHRoaXMuY2xvc2VPbkNsaWNrT3V0c2lkZSl7XG4gICAgICAgICAgICB0aGlzLnBvcHVwLm5hdGl2ZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5ibG9ja01vdXNlRG93bkhhbmRsZXIpO1xuXHQgICAgICAgIGlmICh0aGlzLnRhcmdldFJlZikge1xuXHRcdCAgICAgICAgdGhpcy50YXJnZXRSZWYuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5ibG9ja01vdXNlRG93bkhhbmRsZXIpO1xuXHQgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYmxvY2tNb3VzZURvd25IYW5kbGVyKGV2ZW50OiBhbnkpe1xuXHQgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZW1vdmVDbGlja091dHNpZGVTdXBwb3J0KCl7XG4gICAgICAgIGlmICh0aGlzLmNsb3NlT25DbGlja091dHNpZGUpe1xuICAgICAgICAgICAgdGhpcy5wb3B1cC5uYXRpdmVFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuYmxvY2tNb3VzZURvd25IYW5kbGVyKTtcblx0ICAgICAgICBpZiAodGhpcy50YXJnZXRSZWYpIHtcblx0XHQgICAgICAgIHRoaXMudGFyZ2V0UmVmLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuYmxvY2tNb3VzZURvd25IYW5kbGVyKTtcblx0ICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHJlc3RvcmVQYWdlU2Nyb2xsKHJlc3RvcmVTY3JvbGxQb3NpdGlvbiA9IHRydWUpOnZvaWR7XG5cdCAgICBpZiAodGhpcy5wcmV2ZW50UGFnZVNjcm9sbCl7XG5cdFx0ICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3dZID0gJ2F1dG8nO1xuXHRcdCAgICBkb2N1bWVudC5ib2R5LnN0eWxlLnBvc2l0aW9uID0gJyc7XG5cdFx0ICAgIGlmIChyZXN0b3JlU2Nyb2xsUG9zaXRpb24pIHtcblx0XHRcdCAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgdGhpcy5fc2F2ZVNjcm9sbFBvc2l0aW9uKTtcblx0XHQgICAgfVxuXHQgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgdmFsaWRhdGUoKXtcbiAgICAgICAgbGV0IHZhbGlkOiBib29sZWFuID0gdHlwZW9mIHRoaXMucG9wdXBXaWR0aCAhPT0gJ3VuZGVmaW5lZCcgfHwgdGhpcy5mdWxsU2NyZWVuO1xuICAgICAgICBpZiAoIXZhbGlkKXtcblx0ICAgICAgICB0aGlzLl9zdGF0ZWNoYW5nZS5uZXh0KHtzdGF0ZTogUG9wdXBXaWRnZXRTdGF0ZXMuRGlzYWJsZWR9KTtcblx0ICAgICAgICB0aHJvdyBcIlBvcHVwIHdpZGdldCBlcnJvcjogbWlzc2luZyByZXF1aXJlZCBwYXJhbWV0ZXJzLiBWZXJpZnkgcG9wdXBXaWR0aCBpcyBkZWZpbmVkLlwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWxpZDtcbiAgICB9XG5cblx0cHJpdmF0ZSBhcHBlbmRDaGlsZChlbGVtZW50OiBhbnksIHRhcmdldDogYW55KSB7XG5cdFx0aWYgKHRoaXMuaXNFbGVtZW50KHRhcmdldCkpIHtcblx0XHRcdHRhcmdldC5hcHBlbmRDaGlsZChlbGVtZW50KTtcblx0XHR9ZWxzZSB7XG5cdFx0XHR0aHJvdyAnQ2Fubm90IGFwcGVuZCAnICsgdGFyZ2V0ICsgJyB0byAnICsgZWxlbWVudDtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHJlbW92ZUNoaWxkKGVsZW1lbnQ6IGFueSwgdGFyZ2V0OiBhbnkpIHtcblx0XHRpZiAodGhpcy5pc0VsZW1lbnQodGFyZ2V0KSkge1xuXHRcdFx0dGFyZ2V0LnJlbW92ZUNoaWxkKGVsZW1lbnQpO1xuXHRcdH1lbHNlIHtcblx0XHRcdHRocm93ICdDYW5ub3QgcmVtb3ZlICcgKyB0YXJnZXQgKyAnIGZyb20gJyArIGVsZW1lbnQ7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBpc0VsZW1lbnQob2JqOiBhbnkpIHtcblx0XHRyZXR1cm4gKHR5cGVvZiBIVE1MRWxlbWVudCA9PT0gXCJvYmplY3RcIiA/IG9iaiBpbnN0YW5jZW9mIEhUTUxFbGVtZW50IDpcblx0XHRcdG9iaiAmJiB0eXBlb2Ygb2JqID09PSBcIm9iamVjdFwiICYmIG9iaiAhPT0gbnVsbCAmJiBvYmoubm9kZVR5cGUgPT09IDEgJiYgdHlwZW9mIG9iai5ub2RlTmFtZSA9PT0gXCJzdHJpbmdcIlxuXHRcdCk7XG5cdH1cblxuXHRwcml2YXRlIHNldFBvc2l0aW9uKCkge1xuICAgIGNvbnN0IHBvcHVwSGVpZ2h0ID0gdGhpcy5wb3B1cC5uYXRpdmVFbGVtZW50LmNsaWVudEhlaWdodDtcblx0XHRjb25zdCBwb3B1cFdpZHRoID0gdGhpcy5wb3B1cC5uYXRpdmVFbGVtZW50LmNsaWVudFdpZHRoO1xuXG4gICAgaWYgKHRoaXMubW9kYWwgfHwgdGhpcy5zbGlkZXIpIHtcbiAgICAgIHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5zdHlsZS5tYXJnaW5MZWZ0ID0gd2luZG93LmlubmVyV2lkdGggLyAyIC0gdGhpcy5wb3B1cFdpZHRoIC8gMiArICdweCc7XG5cbiAgICAgIGlmICh0aGlzLm1vZGFsKSB7XG4gICAgICAgIGNvbnN0IG1vZGFsTWFyZ2luVG9wID0gKFxuICAgICAgICAgIHdpbmRvdy5pbm5lckhlaWdodCAvIDIgLVxuICAgICAgICAgIHBvcHVwSGVpZ2h0IC8gMlxuICAgICAgICApO1xuICAgICAgICB0aGlzLnBvcHVwLm5hdGl2ZUVsZW1lbnQuc3R5bGUubWFyZ2luVG9wID0gTWF0aC5yb3VuZChtb2RhbE1hcmdpblRvcCkgKyAncHgnO1xuICAgICAgICB0aGlzLnBvcHVwLm5hdGl2ZUVsZW1lbnQuc3R5bGUub3BhY2l0eSA9IDE7XG4gICAgICB9XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdGlmICghdGhpcy5fdGFyZ2V0UmVmKSByZXR1cm47XG5cblx0XHRjb25zdCBwb3B1cEJveCA9IHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XHRjb25zdCB0YXJnZXRSZWZCb3ggPSB0aGlzLl90YXJnZXRSZWYuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0Y29uc3QgcGFyZW50VG9wID0gdGhpcy5hcHBlbmRUbyAmJiAhdGhpcy5tb2RhbCA/IHRoaXMuYXBwZW5kVG8uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wIDogMDtcblx0XHRjb25zdCBwYXJlbnRMZWZ0ID0gdGhpcy5hcHBlbmRUbyAmJiAhdGhpcy5tb2RhbCA/IHRoaXMuYXBwZW5kVG8uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCA6IDA7XG5cblx0XHRsZXQgcG9wdXBNYXJnaW5Ub3A6IG51bWJlcjtcblx0XHRsZXQgcG9wdXBNYXJnaW5MZWZ0OiBudW1iZXI7XG5cblx0XHRsZXQgcG9wdXBMZWZ0TWFyZ2luczogUG9wdXBXaWRnZXRYTWFyZ2lucyA9IHt9XG5cdFx0bGV0IHBvcHVwVG9wTWFyZ2luczogUG9wdXBXaWRnZXRZTWFyZ2lucyA9IHt9XG5cblx0XHRwb3B1cFRvcE1hcmdpbnMudG9wID0gKFxuXHRcdFx0dGFyZ2V0UmVmQm94LnRvcFxuXHRcdFx0LSBwYXJlbnRUb3Bcblx0XHRcdC0gcG9wdXBIZWlnaHRcblx0XHRcdCsgdGhpcy50YXJnZXRSZWYub2Zmc2V0SGVpZ2h0XG5cdFx0XHQtIHRoaXMudGFyZ2V0T2Zmc2V0Wyd5J11cblx0XHQpO1xuXG5cdFx0cG9wdXBUb3BNYXJnaW5zLmJvdHRvbSA9IChcblx0XHRcdHRhcmdldFJlZkJveC50b3Bcblx0XHRcdC0gcGFyZW50VG9wXG5cdFx0XHQrIHRoaXMudGFyZ2V0T2Zmc2V0Wyd5J11cblx0XHQpO1xuXG5cdFx0cG9wdXBUb3BNYXJnaW5zLmNlbnRlciA9IChcblx0XHRcdHRhcmdldFJlZkJveC50b3Bcblx0XHRcdC0gcGFyZW50VG9wXG5cdFx0XHQtIHBvcHVwSGVpZ2h0IC8gMlxuXHRcdFx0KyB0aGlzLnRhcmdldFJlZi5vZmZzZXRIZWlnaHQgLyAyXG5cdFx0XHQrIHRoaXMudGFyZ2V0T2Zmc2V0Wyd5J11cblx0XHQpO1xuXG5cdFx0cG9wdXBMZWZ0TWFyZ2lucy5sZWZ0ID0gKFxuXHRcdFx0dGFyZ2V0UmVmQm94LmxlZnRcblx0XHRcdC0gcGFyZW50TGVmdFxuXHRcdFx0LSBwb3B1cFdpZHRoXG5cdFx0XHQrIHRoaXMudGFyZ2V0UmVmLmNsaWVudFdpZHRoXG5cdFx0XHQtIHRoaXMudGFyZ2V0T2Zmc2V0Wyd4J11cblx0XHQpO1xuXG5cdFx0cG9wdXBMZWZ0TWFyZ2lucy5yaWdodCA9IChcblx0XHRcdHRhcmdldFJlZkJveC5sZWZ0XG5cdFx0XHQtIHBhcmVudExlZnRcblx0XHRcdCsgdGhpcy50YXJnZXRPZmZzZXRbJ3gnXVxuXHRcdCk7XG5cblx0XHRwb3B1cExlZnRNYXJnaW5zLmNlbnRlciA9IChcblx0XHRcdHRhcmdldFJlZkJveC5sZWZ0XG5cdFx0XHQtIHBhcmVudExlZnRcblx0XHRcdC0gcG9wdXBXaWR0aCAvIDJcblx0XHRcdCsgdGhpcy50YXJnZXRPZmZzZXRbJ3gnXVxuXHRcdCk7XG5cblx0XHRwb3B1cE1hcmdpblRvcCA9IHRoaXMucGxhY2VtZW50LnkgPyBwb3B1cFRvcE1hcmdpbnNbdGhpcy5wbGFjZW1lbnQueV0gOiBwb3B1cFRvcE1hcmdpbnMuYm90dG9tO1xuXHRcdHBvcHVwTWFyZ2luTGVmdCA9IHRoaXMucGxhY2VtZW50LnggPyBwb3B1cExlZnRNYXJnaW5zW3RoaXMucGxhY2VtZW50LnldIDogcG9wdXBMZWZ0TWFyZ2lucy5yaWdodDtcblxuXHRcdHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5zdHlsZS5tYXJnaW5Ub3AgPSBNYXRoLnJvdW5kKHBvcHVwTWFyZ2luVG9wKSArICdweCc7XG5cdFx0dGhpcy5wb3B1cC5uYXRpdmVFbGVtZW50LnN0eWxlLm1hcmdpbkxlZnQgPSBNYXRoLnJvdW5kKHBvcHVwTWFyZ2luTGVmdCkgKyAncHgnO1xuXG5cdFx0dGhpcy52YWxpZGF0ZVBvc2l0aW9uKHBvcHVwTGVmdE1hcmdpbnMsIHBvcHVwVG9wTWFyZ2lucyk7XG5cdH1cblxuXHQvLyB2YWxpZGF0ZSBwb3B1cCB3aWRnZXQgaXMgbm90IG91dHNpZGUgb2YgdGhlIHZpZXdwb3J0ICgrIGd1dHRlcikgYW5kIGlmIGl0IGlzLCByZXBvc2l0aW9uIGl0XG5cdHByaXZhdGUgdmFsaWRhdGVQb3NpdGlvbihwb3B1cExlZnRNYXJnaW5zOiBQb3B1cFdpZGdldFhNYXJnaW5zLCBwb3B1cFRvcE1hcmdpbnM6IFBvcHVwV2lkZ2V0WU1hcmdpbnMpIHtcblxuXHRcdGNvbnN0IHBvcHVwSGVpZ2h0ID0gdGhpcy5wb3B1cC5uYXRpdmVFbGVtZW50LmNsaWVudEhlaWdodDtcblx0XHRjb25zdCBwb3B1cFdpZHRoID0gdGhpcy5wb3B1cC5uYXRpdmVFbGVtZW50LmNsaWVudFdpZHRoO1xuXHRcdGNvbnN0IHBvcHVwQm94ID0gdGhpcy5wb3B1cC5uYXRpdmVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRcdGNvbnN0IGNsaWVudEhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcblx0XHRjb25zdCBjbGllbnRXaWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xuXG5cdFx0bGV0IHBvcHVwTWFyZ2luVG9wOiBudW1iZXI7XG5cdFx0bGV0IHBvcHVwTWFyZ2luTGVmdDogbnVtYmVyO1xuXG5cdFx0aWYgKHRoaXMucGxhY2VtZW50LnkgPT09ICd0b3AnKSB7XG5cdFx0XHRpZiAocG9wdXBCb3gudG9wIDwgV0lORE9XX0dVVFRFUikge1xuXHRcdFx0XHRwb3B1cE1hcmdpblRvcCA9IHBvcHVwVG9wTWFyZ2lucy5ib3R0b207XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGVsc2UgaWYgKHRoaXMucGxhY2VtZW50LnkgPT09ICdib3R0b20nKSB7XG5cdFx0XHRpZiAocG9wdXBCb3gudG9wICsgcG9wdXBIZWlnaHQgPiBjbGllbnRIZWlnaHQgLSBXSU5ET1dfR1VUVEVSICYmIHBvcHVwQm94LnRvcCA+IGNsaWVudEhlaWdodCkge1xuXHRcdFx0XHRwb3B1cE1hcmdpblRvcCA9IHBvcHVwVG9wTWFyZ2lucy50b3A7XG5cdFx0XHR9ZWxzZSB7XG4gICAgICAgIHBvcHVwTWFyZ2luVG9wID0gcG9wdXBUb3BNYXJnaW5zLmJvdHRvbTtcbiAgICAgIH1cblx0XHR9XG5cdFx0ZWxzZSBpZiAodGhpcy5wbGFjZW1lbnQueSA9PT0gJ2NlbnRlcicpIHtcblx0XHRcdGlmIChwb3B1cEJveC50b3AgPCBXSU5ET1dfR1VUVEVSKSB7XG5cdFx0XHRcdHBvcHVwTWFyZ2luVG9wID0gcG9wdXBUb3BNYXJnaW5zLmJvdHRvbTtcblx0XHRcdH1cblx0XHRcdGVsc2UgaWYgKHBvcHVwQm94LnRvcCArIHBvcHVwSGVpZ2h0ID4gY2xpZW50SGVpZ2h0IC0gV0lORE9XX0dVVFRFUikge1xuXHRcdFx0XHRwb3B1cE1hcmdpblRvcCA9IHBvcHVwVG9wTWFyZ2lucy50b3A7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKHBvcHVwQm94LmxlZnQgKyBwb3B1cFdpZHRoID4gY2xpZW50V2lkdGggKyBXSU5ET1dfR1VUVEVSKSB7XG5cdFx0XHRwb3B1cE1hcmdpbkxlZnQgPSBwb3B1cExlZnRNYXJnaW5zLmxlZnQ7XG5cdFx0fVxuXHRcdGVsc2UgaWYgKHBvcHVwQm94LmxlZnQgPCBXSU5ET1dfR1VUVEVSKSB7XG5cdFx0XHRwb3B1cE1hcmdpbkxlZnQgPSBwb3B1cExlZnRNYXJnaW5zLnJpZ2h0O1xuXHRcdH1cblxuXHRcdHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5zdHlsZS5tYXJnaW5Ub3AgPSBNYXRoLnJvdW5kKHBvcHVwTWFyZ2luVG9wKSArICdweCc7XG5cdFx0dGhpcy5wb3B1cC5uYXRpdmVFbGVtZW50LnN0eWxlLm1hcmdpbkxlZnQgPSBNYXRoLnJvdW5kKHBvcHVwTWFyZ2luTGVmdCkgKyAncHgnO1xuXHRcdHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5zdHlsZS5vcGFjaXR5ID0gMTtcblx0fVxuXG59XG4iXX0=