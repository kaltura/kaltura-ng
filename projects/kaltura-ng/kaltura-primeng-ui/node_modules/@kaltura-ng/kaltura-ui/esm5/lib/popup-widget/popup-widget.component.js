import { __decorate, __metadata } from "tslib";
import { Component, AfterViewInit, EventEmitter, OnDestroy, Input, Output, ElementRef, HostListener, TemplateRef, ContentChild, Renderer2, HostBinding } from "@angular/core";
import { BehaviorSubject } from 'rxjs/BehaviorSubject';
import { PopupWidgetLayout } from './popup-widget-layout';
import 'rxjs/add/observable/fromEvent';
import { cancelOnDestroy } from '@kaltura-ng/kaltura-common';
export var PopupWidgetStates = {
    "Open": "open",
    "BeforeClose": "beforeClose",
    "Close": "close",
    "Disabled": "disabled"
};
var WINDOW_GUTTER = 16;
var PopupWidgetComponent = /** @class */ (function () {
    function PopupWidgetComponent(popup, renderer) {
        var _this = this;
        this.popup = popup;
        this.renderer = renderer;
        this.transparent = false;
        this.popupHeight = 'auto';
        this.showTooltip = false;
        this.preventPageScroll = false;
        this.modal = false;
        this.slider = false;
        this.fullScreen = false;
        this.closeBtn = true;
        this.closeBtnInside = false;
        this.closeOnClickOutside = true;
        this.closeOnResize = false;
        this.closeOnBrowserNav = true;
        this.targetOffset = { 'x': 0, 'y': 0 };
        this.childrenPopups = [];
        this.trigger = 'click';
        this.placement = { x: 'right', y: 'bottom' };
        this.closeOnScroll = false;
        this.opened = false;
        this.closed = false;
        this._toggleFunc = this.toggle.bind(this);
        this._openFunc = this.open.bind(this);
        this._closeFunc = this.close.bind(this);
        this._viewInitialize = false;
        this.onOpen = new EventEmitter();
        this.onClose = new EventEmitter();
        this._stateChangeSubscription = null;
        this._statechange = new BehaviorSubject({ state: '' });
        this.state$ = this._statechange.asObservable();
        this._statechange.next({ state: PopupWidgetStates.Close });
        this.state$
            .pipe(cancelOnDestroy(this))
            .subscribe(function (_a) {
            var state = _a.state;
            _this.closed = state === PopupWidgetStates.Close;
            _this.opened = state === PopupWidgetStates.Open;
        });
    }
    Object.defineProperty(PopupWidgetComponent.prototype, "targetRef", {
        get: function () { return this._targetRef; },
        set: function (targetRef) {
            if (this.trigger === 'click') {
                if (this._targetRef) {
                    this._targetRef.removeEventListener('click', this._toggleFunc);
                }
                this._targetRef = targetRef;
                if (this._targetRef) {
                    this._targetRef.addEventListener('click', this._toggleFunc);
                }
            }
            else if (this.trigger === 'hover') {
                if (this._targetRef) {
                    this._targetRef.removeEventListener('mouseover', this._openFunc);
                    this._targetRef.removeEventListener('mouseout', this._closeFunc);
                }
                this._targetRef = targetRef;
                if (this._targetRef) {
                    this._targetRef.addEventListener('mouseover', this._openFunc);
                    this._targetRef.addEventListener('mouseout', this._closeFunc);
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PopupWidgetComponent.prototype, "parentPopup", {
        get: function () { return this._parentPopup; },
        set: function (parentPopup) {
            var _this = this;
            this._parentPopup = parentPopup;
            if (this._stateChangeSubscription) {
                this._stateChangeSubscription.unsubscribe();
                this._stateChangeSubscription = null;
            }
            if (this._parentPopup) {
                this._stateChangeSubscription = this._parentPopup.state$.subscribe(function (event) {
                    if (event.state === PopupWidgetStates.Close) {
                        _this.close();
                    }
                });
            }
        },
        enumerable: true,
        configurable: true
    });
    // public API methods
    PopupWidgetComponent.prototype.open = function () {
        var _this = this;
        if (this.isEnabled && this.validate()) {
            // handle auto height
            if (!this.popupHeight || this.popupHeight === 'auto') {
                if (this.slider) {
                    this._popupWidgetHeight = 'calc(100vh - 80px)';
                }
                else {
                    this._popupWidgetHeight = 'auto';
                }
            }
            else {
                this._popupWidgetHeight = this.popupHeight + "px";
            }
            this._saveScrollPosition = window.pageYOffset || document.documentElement.scrollTop;
            // set location according to targetRef
            var parentLeft = this.appendTo && !this.modal ? this.appendTo.getBoundingClientRect().left : 0;
            var parentTop = this.appendTo && !this.modal ? this.appendTo.getBoundingClientRect().top : 0;
            // center on screen if no targetRef was defined
            if (!this._targetRef) {
                if (this.fullScreen) {
                    this.modal = false;
                    this.preventPageScroll = true;
                    this.renderer.addClass(this.popup.nativeElement, 'fullScreen');
                }
                else {
                    this.popup.nativeElement.style.marginLeft = window.innerWidth / 2 - this.popupWidth / 2 + 'px';
                    if (this.slider) {
                        window.scrollTo(0, 0);
                        this.popup.nativeElement.style.top = "auto";
                        this.closeBtn = false;
                        this.preventPageScroll = true;
                        this.popup.nativeElement.style.bottom = this.popupHeight !== 'auto' ? this.popupHeight * -1 + "px" : "-1000px";
                        setTimeout(function () {
                            _this.popup.nativeElement.style.bottom = 0 + "px"; // use timeout to invoke animation
                        }, 0);
                    }
                    else {
                        var marginTop = (window.innerHeight / 2 - 100 / 2);
                        this.popup.nativeElement.style.marginTop = marginTop + 'px';
                        this.popup.nativeElement.style.position = "fixed";
                    }
                }
            }
            else {
                this.popup.nativeElement.style.marginLeft = this._targetRef.getBoundingClientRect().left - parentLeft + this.targetOffset['x'] + 'px';
                this.popup.nativeElement.style.marginTop = this._targetRef.getBoundingClientRect().top - parentTop + this.targetOffset['y'] + 'px';
                this.popup.nativeElement.style.position = "absolute";
            }
            this.popup.nativeElement.style.zIndex = PopupWidgetLayout.getPopupZindex(this.fullScreen);
            // handle modal
            if (!this._modalOverlay) {
                if (this.trigger !== 'hover') {
                    this._modalOverlay = document.createElement('div');
                    if (this.modal || this.slider) {
                        this._modalOverlay.className = "kPopupWidgetModalOverlay";
                    }
                    else {
                        this._modalOverlay.className = "kPopupWidgetModalOverlay kTransparent";
                    }
                    this._modalOverlay.style.zIndex = this.popup.nativeElement.style.zIndex - 1;
                    if (!this.slider && this.closeOnClickOutside) {
                        this._modalOverlay.addEventListener("mousedown", function (event) {
                            event.stopPropagation();
                            _this.close();
                        });
                    }
                    if (this.appendTo) {
                        this.appendChild(this._modalOverlay, this.appendTo);
                    }
                    else {
                        document.body.appendChild(this._modalOverlay);
                    }
                    if (this.modal || this.slider) {
                        PopupWidgetLayout.increaseModalCount();
                    }
                }
            }
            // prevent page scroll
            if (this.preventPageScroll) {
                document.body.style.overflowY = 'hidden';
                document.body.style.position = 'fixed';
            }
            setTimeout(function () {
                _this.addClickOutsideSupport();
            }, 0);
            this.onOpen.emit(); // dispatch onOpen event (API)
            this._statechange.next({ state: PopupWidgetStates.Open });
            if (this.closeOnScroll && this.isShow) {
                window.addEventListener('scroll', this._closeFunc);
            }
        }
        if (!this.slider && !this.fullScreen && this.popup.nativeElement) {
            this.popup.nativeElement.style.opacity = 0;
        }
        // auto positioning need first the dom to render
        setTimeout(function () {
            _this.setPosition();
        }, 0);
    };
    PopupWidgetComponent.prototype.close = function (context, reason) {
        var _this = this;
        if (context === void 0) { context = null; }
        if (reason === void 0) { reason = null; }
        if (this.isEnabled && this.isShow) {
            window.removeEventListener('scroll', this._closeFunc);
            if (this.fullScreen) {
                this.renderer.removeClass(this.popup.nativeElement, 'fullScreen');
            }
            // allow cancelling the close operation
            var beforeCloseContext = { "allowClose": true };
            this._statechange.next({ state: PopupWidgetStates.BeforeClose, context: beforeCloseContext });
            if (beforeCloseContext['allowClose']) {
                // close children popups if exist
                if (this.childrenPopups.length) {
                    this.childrenPopups.forEach(function (popup) {
                        popup.close();
                    });
                }
                this.removeClickOutsideSupport();
                this.restorePageScroll(true);
                this.onClose.emit(); // dispatch onClose event (API)
                var timeout = 0;
                if (this.slider) {
                    this.popup.nativeElement.style.bottom = this.popupHeight !== 'auto' ? this.popupHeight * -1 + "px" : "-1000px";
                    timeout = 300;
                }
                if (this.modal && !this.slider) {
                    PopupWidgetLayout.decreaseModalCount();
                }
                setTimeout(function () {
                    // remove modal
                    if (_this._modalOverlay) {
                        if (_this.appendTo) {
                            _this.removeChild(_this._modalOverlay, _this.appendTo);
                        }
                        else {
                            document.body.removeChild(_this._modalOverlay);
                        }
                        _this._modalOverlay = null;
                    }
                    if (_this.slider) {
                        PopupWidgetLayout.decreaseModalCount();
                    }
                    _this._statechange.next({ state: PopupWidgetStates.Close, context: context, reason: reason }); // use timeout to prevent valueChangeAfterChecked error
                }, timeout);
            }
        }
    };
    PopupWidgetComponent.prototype.toggle = function () {
        if (this.isEnabled) {
            this.isShow ? this.close() : this.open();
        }
    };
    Object.defineProperty(PopupWidgetComponent.prototype, "isShow", {
        get: function () {
            return this._statechange.getValue().state !== PopupWidgetStates.Close;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PopupWidgetComponent.prototype, "isEnabled", {
        get: function () {
            return this._statechange.getValue().state !== PopupWidgetStates.Disabled;
        },
        enumerable: true,
        configurable: true
    });
    PopupWidgetComponent.prototype.onWindowResize = function () {
        if (this.closeOnResize) {
            this.close();
        }
        else {
            this.setPosition();
        }
    };
    PopupWidgetComponent.prototype.onPopState = function (event) {
        if (this.closeOnBrowserNav) {
            this.close();
        }
    };
    // component lifecycle events
    PopupWidgetComponent.prototype.ngAfterViewInit = function () {
        this._viewInitialize = true;
        if (this.validate()) {
            if (this.appendTo && !this.modal) {
                this.appendChild(this.popup.nativeElement, this.appendTo);
            }
            else {
                document.body.appendChild(this.popup.nativeElement);
                if (this.appendTo) {
                    console.warn("[kaltura] -> Ignoring append to " + this.appendTo + " since popup is set to modal=true."); // keep warning
                }
            }
            if (this.fullScreen) {
                this.popup.nativeElement.style.width = '0px';
                this.popup.nativeElement.style.height = '0px';
            }
        }
    };
    PopupWidgetComponent.prototype.ngOnDestroy = function () {
        if (this._targetRef) {
            this._targetRef.removeEventListener('click', this._toggleFunc);
            this._targetRef.removeEventListener('mouseover', this._openFunc);
            this._targetRef.removeEventListener('mouseout', this._closeFunc);
        }
        if (this._stateChangeSubscription) {
            this._stateChangeSubscription.unsubscribe();
        }
        this._statechange.complete();
        this.removeClickOutsideSupport();
        this.restorePageScroll(false);
        if (this.modal && this._modalOverlay) {
            document.body.removeChild(this._modalOverlay);
            this._modalOverlay = null;
        }
        if (this.appendTo && !this.modal) {
            this.removeChild(this.popup.nativeElement, this.appendTo);
        }
        else {
            if (this._viewInitialize) {
                document.body.removeChild(this.popup.nativeElement);
            }
        }
        window.removeEventListener('scroll', this._closeFunc);
    };
    // private methods
    PopupWidgetComponent.prototype.addClickOutsideSupport = function () {
        if (this.closeOnClickOutside) {
            this.popup.nativeElement.addEventListener('mousedown', this.blockMouseDownHandler);
            if (this.targetRef) {
                this.targetRef.addEventListener('mousedown', this.blockMouseDownHandler);
            }
        }
    };
    PopupWidgetComponent.prototype.blockMouseDownHandler = function (event) {
        event.stopPropagation();
    };
    PopupWidgetComponent.prototype.removeClickOutsideSupport = function () {
        if (this.closeOnClickOutside) {
            this.popup.nativeElement.removeEventListener('mousedown', this.blockMouseDownHandler);
            if (this.targetRef) {
                this.targetRef.removeEventListener('mousedown', this.blockMouseDownHandler);
            }
        }
    };
    PopupWidgetComponent.prototype.restorePageScroll = function (restoreScrollPosition) {
        if (restoreScrollPosition === void 0) { restoreScrollPosition = true; }
        if (this.preventPageScroll) {
            document.body.style.overflowY = 'auto';
            document.body.style.position = '';
            if (restoreScrollPosition) {
                window.scrollTo(0, this._saveScrollPosition);
            }
        }
    };
    PopupWidgetComponent.prototype.validate = function () {
        var valid = typeof this.popupWidth !== 'undefined' || this.fullScreen;
        if (!valid) {
            this._statechange.next({ state: PopupWidgetStates.Disabled });
            throw "Popup widget error: missing required parameters. Verify popupWidth is defined.";
        }
        return valid;
    };
    PopupWidgetComponent.prototype.appendChild = function (element, target) {
        if (this.isElement(target)) {
            target.appendChild(element);
        }
        else {
            throw 'Cannot append ' + target + ' to ' + element;
        }
    };
    PopupWidgetComponent.prototype.removeChild = function (element, target) {
        if (this.isElement(target)) {
            target.removeChild(element);
        }
        else {
            throw 'Cannot remove ' + target + ' from ' + element;
        }
    };
    PopupWidgetComponent.prototype.isElement = function (obj) {
        return (typeof HTMLElement === "object" ? obj instanceof HTMLElement :
            obj && typeof obj === "object" && obj !== null && obj.nodeType === 1 && typeof obj.nodeName === "string");
    };
    PopupWidgetComponent.prototype.setPosition = function () {
        var popupHeight = this.popup.nativeElement.clientHeight;
        var popupWidth = this.popup.nativeElement.clientWidth;
        if (this.modal || this.slider) {
            this.popup.nativeElement.style.marginLeft = window.innerWidth / 2 - this.popupWidth / 2 + 'px';
            if (this.modal) {
                var modalMarginTop = (window.innerHeight / 2 -
                    popupHeight / 2);
                this.popup.nativeElement.style.marginTop = Math.round(modalMarginTop) + 'px';
                this.popup.nativeElement.style.opacity = 1;
            }
            return;
        }
        if (!this._targetRef)
            return;
        var popupBox = this.popup.nativeElement.getBoundingClientRect();
        var targetRefBox = this._targetRef.getBoundingClientRect();
        var parentTop = this.appendTo && !this.modal ? this.appendTo.getBoundingClientRect().top : 0;
        var parentLeft = this.appendTo && !this.modal ? this.appendTo.getBoundingClientRect().left : 0;
        var popupMarginTop;
        var popupMarginLeft;
        var popupLeftMargins = {};
        var popupTopMargins = {};
        popupTopMargins.top = (targetRefBox.top
            - parentTop
            - popupHeight
            + this.targetRef.offsetHeight
            - this.targetOffset['y']);
        popupTopMargins.bottom = (targetRefBox.top
            - parentTop
            + this.targetOffset['y']);
        popupTopMargins.center = (targetRefBox.top
            - parentTop
            - popupHeight / 2
            + this.targetRef.offsetHeight / 2
            + this.targetOffset['y']);
        popupLeftMargins.left = (targetRefBox.left
            - parentLeft
            - popupWidth
            + this.targetRef.clientWidth
            - this.targetOffset['x']);
        popupLeftMargins.right = (targetRefBox.left
            - parentLeft
            + this.targetOffset['x']);
        popupLeftMargins.center = (targetRefBox.left
            - parentLeft
            - popupWidth / 2
            + this.targetOffset['x']);
        popupMarginTop = this.placement.y ? popupTopMargins[this.placement.y] : popupTopMargins.bottom;
        popupMarginLeft = this.placement.x ? popupLeftMargins[this.placement.y] : popupLeftMargins.right;
        this.popup.nativeElement.style.marginTop = Math.round(popupMarginTop) + 'px';
        this.popup.nativeElement.style.marginLeft = Math.round(popupMarginLeft) + 'px';
        this.validatePosition(popupLeftMargins, popupTopMargins);
    };
    // validate popup widget is not outside of the viewport (+ gutter) and if it is, reposition it
    PopupWidgetComponent.prototype.validatePosition = function (popupLeftMargins, popupTopMargins) {
        var popupHeight = this.popup.nativeElement.clientHeight;
        var popupWidth = this.popup.nativeElement.clientWidth;
        var popupBox = this.popup.nativeElement.getBoundingClientRect();
        var clientHeight = window.innerHeight;
        var clientWidth = window.innerWidth;
        var popupMarginTop;
        var popupMarginLeft;
        if (this.placement.y === 'top') {
            if (popupBox.top < WINDOW_GUTTER) {
                popupMarginTop = popupTopMargins.bottom;
            }
        }
        else if (this.placement.y === 'bottom') {
            if (popupBox.top + popupHeight > clientHeight - WINDOW_GUTTER && popupBox.top > clientHeight) {
                popupMarginTop = popupTopMargins.top;
            }
            else {
                popupMarginTop = popupTopMargins.bottom;
            }
        }
        else if (this.placement.y === 'center') {
            if (popupBox.top < WINDOW_GUTTER) {
                popupMarginTop = popupTopMargins.bottom;
            }
            else if (popupBox.top + popupHeight > clientHeight - WINDOW_GUTTER) {
                popupMarginTop = popupTopMargins.top;
            }
        }
        if (popupBox.left + popupWidth > clientWidth + WINDOW_GUTTER) {
            popupMarginLeft = popupLeftMargins.left;
        }
        else if (popupBox.left < WINDOW_GUTTER) {
            popupMarginLeft = popupLeftMargins.right;
        }
        this.popup.nativeElement.style.marginTop = Math.round(popupMarginTop) + 'px';
        this.popup.nativeElement.style.marginLeft = Math.round(popupMarginLeft) + 'px';
        this.popup.nativeElement.style.opacity = 1;
    };
    PopupWidgetComponent.ctorParameters = function () { return [
        { type: ElementRef },
        { type: Renderer2 }
    ]; };
    __decorate([
        Input(),
        __metadata("design:type", Object)
    ], PopupWidgetComponent.prototype, "transparent", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Object)
    ], PopupWidgetComponent.prototype, "appendTo", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Number)
    ], PopupWidgetComponent.prototype, "popupWidth", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Object)
    ], PopupWidgetComponent.prototype, "popupHeight", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Boolean)
    ], PopupWidgetComponent.prototype, "showTooltip", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Boolean)
    ], PopupWidgetComponent.prototype, "preventPageScroll", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Boolean)
    ], PopupWidgetComponent.prototype, "modal", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Boolean)
    ], PopupWidgetComponent.prototype, "slider", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Boolean)
    ], PopupWidgetComponent.prototype, "fullScreen", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Boolean)
    ], PopupWidgetComponent.prototype, "closeBtn", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Boolean)
    ], PopupWidgetComponent.prototype, "closeBtnInside", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Boolean)
    ], PopupWidgetComponent.prototype, "closeOnClickOutside", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Boolean)
    ], PopupWidgetComponent.prototype, "closeOnResize", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Boolean)
    ], PopupWidgetComponent.prototype, "closeOnBrowserNav", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Object)
    ], PopupWidgetComponent.prototype, "targetOffset", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Array)
    ], PopupWidgetComponent.prototype, "childrenPopups", void 0);
    __decorate([
        Input(),
        __metadata("design:type", String)
    ], PopupWidgetComponent.prototype, "trigger", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Object)
    ], PopupWidgetComponent.prototype, "placement", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Boolean)
    ], PopupWidgetComponent.prototype, "closeOnScroll", void 0);
    __decorate([
        ContentChild(TemplateRef, { static: true }),
        __metadata("design:type", TemplateRef)
    ], PopupWidgetComponent.prototype, "_template", void 0);
    __decorate([
        HostBinding('class.opened'),
        __metadata("design:type", Object)
    ], PopupWidgetComponent.prototype, "opened", void 0);
    __decorate([
        HostBinding('class.closed'),
        __metadata("design:type", Object)
    ], PopupWidgetComponent.prototype, "closed", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Object),
        __metadata("design:paramtypes", [Object])
    ], PopupWidgetComponent.prototype, "targetRef", null);
    __decorate([
        Input(),
        __metadata("design:type", PopupWidgetComponent),
        __metadata("design:paramtypes", [PopupWidgetComponent])
    ], PopupWidgetComponent.prototype, "parentPopup", null);
    __decorate([
        Output(),
        __metadata("design:type", Object)
    ], PopupWidgetComponent.prototype, "onOpen", void 0);
    __decorate([
        Output(),
        __metadata("design:type", Object)
    ], PopupWidgetComponent.prototype, "onClose", void 0);
    __decorate([
        HostListener("window:resize", []),
        __metadata("design:type", Function),
        __metadata("design:paramtypes", []),
        __metadata("design:returntype", void 0)
    ], PopupWidgetComponent.prototype, "onWindowResize", null);
    __decorate([
        HostListener('window:popstate', ['$event']),
        __metadata("design:type", Function),
        __metadata("design:paramtypes", [Object]),
        __metadata("design:returntype", void 0)
    ], PopupWidgetComponent.prototype, "onPopState", null);
    PopupWidgetComponent = __decorate([
        Component({
            selector: 'kPopupWidget',
            template: "<div #container\n     class=\"kPopupWidget\"\n     [class.transparent]=\"transparent\"\n     [class.slider]=\"slider\"\n     [style.display]=\"(state$ | async)?.state !== 'close' ? 'block' : 'none'\"\n     [style.width]=\"popupWidth+'px'\"\n     [style.height]=\"_popupWidgetHeight\">\n    <div class=\"tooltipUp\" *ngIf=\"showTooltip\" [style.marginLeft]=\"popupWidth/2-12+'px'\"></div>\n    <i *ngIf=\"closeBtn\" class=\"kCloseBtn kIconclose_small\" [class.closeBtnInside]=\"closeBtnInside\" (click)=\"close()\"></i>\n    <div class=\"kPopupWidgetContent\" *ngIf=\"isShow\">\n        <ng-content *ngIf=\"!_template\"></ng-content>\n\t\t<ng-template *ngIf=\"_template\"\n\t\t\t[ngTemplateOutlet]=\"_template\">\n\t\t</ng-template>\n    </div>\n</div>\n",
            styles: [":host{position:absolute;left:0;top:0;transition:bottom .3s ease-in-out}:host.fullScreen{width:100%!important;height:100%!important;position:fixed}.kPopupWidget{background-color:#fff;border-radius:4px;box-shadow:0 16px 20px 0 rgba(0,0,0,.3)}.kPopupWidget.slider{border-bottom-right-radius:0;border-bottom-left-radius:0}.kPopupWidget.transparent{box-shadow:none;background:0}.kPopupWidget .kCloseBtn:not(.closeBtnInside){position:absolute;right:-118px;top:-62px;width:38px;height:38px;background-color:rgba(255,255,255,.2);border-radius:50%;text-align:center;padding-top:11px;padding-left:2px;box-sizing:border-box;color:#fff;cursor:pointer}.kPopupWidget .kCloseBtn:not(.closeBtnInside):hover{background-color:rgba(255,255,255,.4)}.kPopupWidget .kCloseBtn.closeBtnInside{font-size:14px;float:right;color:#999;margin-top:14px;margin-right:14px;cursor:pointer}.kPopupWidget .kCloseBtn.closeBtnInside:hover{color:#00a784}.kPopupWidget .tooltipUp{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAOCAYAAAA1+Nx+AAAAAXNSR0IArs4c6QAAAMpJREFUOBGtk0EOwiAQRcF0Z2JXspFTcAE9erkACXfADa50b3DGMAYjlGktSUNDhvfmlyLEguG9V86544ItQnKLEZxSslCfpJQXY8yNs3fHKcrwSSl1gGcE0cRN0k1AnSNca33ChkII1xjjA5Kce0lmE5SdExwF+I5CTpJmggI+lnAU0MhJ7nNnUhVw4FzJj2AJnCP5EmS4LQ+UIL25dfAfwT9wktckb8EW8JZEbgmvSQa8/mu+OcFqM/3WcBntAPA9LdSK165l5vMFmCyyP+zXS30AAAAASUVORK5CYII=);position:absolute;margin-top:-12px;width:24px;height:12px}"]
        }),
        __metadata("design:paramtypes", [ElementRef, Renderer2])
    ], PopupWidgetComponent);
    return PopupWidgetComponent;
}());
export { PopupWidgetComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG9wdXAtd2lkZ2V0LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BrYWx0dXJhLW5nL2thbHR1cmEtdWkvIiwic291cmNlcyI6WyJsaWIvcG9wdXAtd2lkZ2V0L3BvcHVwLXdpZGdldC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFDTCxTQUFTLEVBQ1QsYUFBYSxFQUNiLFlBQVksRUFDWixTQUFTLEVBQ1QsS0FBSyxFQUNMLE1BQU0sRUFDTixVQUFVLEVBQ1YsWUFBWSxFQUNaLFdBQVcsRUFDWCxZQUFZLEVBQ1osU0FBUyxFQUNULFdBQVcsRUFDWixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFHdkQsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFDMUQsT0FBTywrQkFBK0IsQ0FBQztBQUN2QyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFFN0QsTUFBTSxDQUFDLElBQU0saUJBQWlCLEdBQUc7SUFDN0IsTUFBTSxFQUFFLE1BQU07SUFDakIsYUFBYSxFQUFFLGFBQWE7SUFDekIsT0FBTyxFQUFFLE9BQU87SUFDbkIsVUFBVSxFQUFFLFVBQVU7Q0FDdEIsQ0FBQTtBQVlELElBQU0sYUFBYSxHQUFHLEVBQUUsQ0FBQztBQU96QjtJQXFGSSw4QkFBbUIsS0FBaUIsRUFBVSxRQUFtQjtRQUFqRSxpQkFRQztRQVJrQixVQUFLLEdBQUwsS0FBSyxDQUFZO1FBQVUsYUFBUSxHQUFSLFFBQVEsQ0FBVztRQXBGM0QsZ0JBQVcsR0FBRyxLQUFLLENBQUM7UUFHakIsZ0JBQVcsR0FBb0IsTUFBTSxDQUFDO1FBQ3pDLGdCQUFXLEdBQVksS0FBSyxDQUFDO1FBQzdCLHNCQUFpQixHQUFZLEtBQUssQ0FBQztRQUNuQyxVQUFLLEdBQVksS0FBSyxDQUFDO1FBQ3ZCLFdBQU0sR0FBWSxLQUFLLENBQUM7UUFD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VyxDQUFDLGNBQWMsQ0FBQzs7d0RBQWdCO0lBU3BDO1FBQVIsS0FBSyxFQUFFOzs7eURBcUJQO0lBR1E7UUFBUixLQUFLLEVBQUU7a0NBQThCLG9CQUFvQjt5Q0FBcEIsb0JBQW9COzJEQWF6RDtJQUdTO1FBQVQsTUFBTSxFQUFFOzt3REFBa0M7SUFDOUI7UUFBVCxNQUFNLEVBQUU7O3lEQUFtQztJQTBML0M7UUFEQyxZQUFZLENBQUMsZUFBZSxFQUFFLEVBQUUsQ0FBQzs7Ozs4REFPakM7SUFHQTtRQURDLFlBQVksQ0FBQyxpQkFBaUIsRUFBRSxDQUFDLFFBQVEsQ0FBQyxDQUFDOzs7OzBEQUszQztJQWhSVSxvQkFBb0I7UUFMaEMsU0FBUyxDQUFDO1lBQ1AsUUFBUSxFQUFFLGNBQWM7WUFDeEIsNnZCQUE0Qzs7U0FFL0MsQ0FBQzt5Q0FzRjRCLFVBQVUsRUFBb0IsU0FBUztPQXJGeEQsb0JBQW9CLENBb2dCaEM7SUFBRCwyQkFBQztDQUFBLEFBcGdCRCxJQW9nQkM7U0FwZ0JZLG9CQUFvQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIENvbXBvbmVudCxcbiAgQWZ0ZXJWaWV3SW5pdCxcbiAgRXZlbnRFbWl0dGVyLFxuICBPbkRlc3Ryb3ksXG4gIElucHV0LFxuICBPdXRwdXQsXG4gIEVsZW1lbnRSZWYsXG4gIEhvc3RMaXN0ZW5lcixcbiAgVGVtcGxhdGVSZWYsXG4gIENvbnRlbnRDaGlsZCxcbiAgUmVuZGVyZXIyLFxuICBIb3N0QmluZGluZ1xufSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xuaW1wb3J0IHsgQmVoYXZpb3JTdWJqZWN0IH0gZnJvbSAncnhqcy9CZWhhdmlvclN1YmplY3QnO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMvT2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBJU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcy9TdWJzY3JpcHRpb24nO1xuaW1wb3J0IHsgUG9wdXBXaWRnZXRMYXlvdXQgfSBmcm9tICcuL3BvcHVwLXdpZGdldC1sYXlvdXQnO1xuaW1wb3J0ICdyeGpzL2FkZC9vYnNlcnZhYmxlL2Zyb21FdmVudCc7XG5pbXBvcnQgeyBjYW5jZWxPbkRlc3Ryb3kgfSBmcm9tICdAa2FsdHVyYS1uZy9rYWx0dXJhLWNvbW1vbic7XG5cbmV4cG9ydCBjb25zdCBQb3B1cFdpZGdldFN0YXRlcyA9IHtcbiAgICBcIk9wZW5cIjogXCJvcGVuXCIsXG5cdFwiQmVmb3JlQ2xvc2VcIjogXCJiZWZvcmVDbG9zZVwiLFxuICAgIFwiQ2xvc2VcIjogXCJjbG9zZVwiLFxuXHRcIkRpc2FibGVkXCI6IFwiZGlzYWJsZWRcIlxufVxuZXhwb3J0IHR5cGUgcG9wdXBTdGF0dXMgPSB7XG5cdHN0YXRlOiBzdHJpbmcsXG5cdGNvbnRleHQ/OiBhbnksXG5cdHJlYXNvbj86IHN0cmluZ1xufVxuXG5leHBvcnQgdHlwZSBQb3B1cFdpZGdldFhQb3NpdGlvbnMgPSAnbGVmdCcgfCAncmlnaHQnIHwgJ2NlbnRlcic7XG5leHBvcnQgdHlwZSBQb3B1cFdpZGdldFlQb3NpdGlvbnMgPSAndG9wJyB8ICdib3R0b20nIHwgJ2NlbnRlcic7XG50eXBlIFBvcHVwV2lkZ2V0WE1hcmdpbnMgPSB7bGVmdD86IG51bWJlciwgcmlnaHQ/OiBudW1iZXIsIGNlbnRlcj86IG51bWJlcn1cbnR5cGUgUG9wdXBXaWRnZXRZTWFyZ2lucyA9IHt0b3A/OiBudW1iZXIsIGJvdHRvbT86IG51bWJlciwgY2VudGVyPzogbnVtYmVyfVxuXG5jb25zdCBXSU5ET1dfR1VUVEVSID0gMTY7XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAna1BvcHVwV2lkZ2V0JyxcbiAgICB0ZW1wbGF0ZVVybDogJy4vcG9wdXAtd2lkZ2V0LmNvbXBvbmVudC5odG1sJyxcbiAgICBzdHlsZVVybHM6IFsnLi9wb3B1cC13aWRnZXQuY29tcG9uZW50LnNjc3MnXVxufSlcbmV4cG9ydCBjbGFzcyBQb3B1cFdpZGdldENvbXBvbmVudCBpbXBsZW1lbnRzIEFmdGVyVmlld0luaXQsIE9uRGVzdHJveXtcblx0QElucHV0KCkgdHJhbnNwYXJlbnQgPSBmYWxzZTtcblx0QElucHV0KCkgYXBwZW5kVG86IGFueTtcblx0QElucHV0KCkgcG9wdXBXaWR0aDogbnVtYmVyO1xuICAgIEBJbnB1dCgpIHBvcHVwSGVpZ2h0OiBudW1iZXIgfCAnYXV0bycgPSAnYXV0byc7XG5cdEBJbnB1dCgpIHNob3dUb29sdGlwOiBib29sZWFuID0gZmFsc2U7XG5cdEBJbnB1dCgpIHByZXZlbnRQYWdlU2Nyb2xsOiBib29sZWFuID0gZmFsc2U7XG5cdEBJbnB1dCgpIG1vZGFsOiBib29sZWFuID0gZmFsc2U7XG5cdEBJbnB1dCgpIHNsaWRlcjogYm9vbGVhbiA9IGZhbHNlO1xuXHRASW5wdXQoKSBmdWxsU2NyZWVuOiBib29sZWFuID0gZmFsc2U7XG5cdEBJbnB1dCgpIGNsb3NlQnRuOiBib29sZWFuID0gdHJ1ZTtcblx0QElucHV0KCkgY2xvc2VCdG5JbnNpZGU6IGJvb2xlYW4gPSBmYWxzZTtcblx0QElucHV0KCkgY2xvc2VPbkNsaWNrT3V0c2lkZTogYm9vbGVhbiA9IHRydWU7XG5cdEBJbnB1dCgpIGNsb3NlT25SZXNpemU6IGJvb2xlYW4gPSBmYWxzZTtcblx0QElucHV0KCkgY2xvc2VPbkJyb3dzZXJOYXY6IGJvb2xlYW4gPSB0cnVlO1xuXHRASW5wdXQoKSB0YXJnZXRPZmZzZXQ6IGFueSA9IHsneCc6MCwgJ3knOiAwfTtcblx0QElucHV0KCkgY2hpbGRyZW5Qb3B1cHM6IFBvcHVwV2lkZ2V0Q29tcG9uZW50W10gPSBbXTtcblx0QElucHV0KCkgdHJpZ2dlcjogJ2NsaWNrJyB8ICdob3ZlcicgPSAnY2xpY2snO1xuXHRASW5wdXQoKSBwbGFjZW1lbnQ6IHt4OiBQb3B1cFdpZGdldFhQb3NpdGlvbnMsIHk6IFBvcHVwV2lkZ2V0WVBvc2l0aW9uc30gPSB7eDogJ3JpZ2h0JywgeTogJ2JvdHRvbSd9XG4gIEBJbnB1dCgpIGNsb3NlT25TY3JvbGw6IGJvb2xlYW4gPSBmYWxzZTtcblxuICBAQ29udGVudENoaWxkKFRlbXBsYXRlUmVmLCB7IHN0YXRpYzogdHJ1ZSB9KSBwdWJsaWMgX3RlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+O1xuICBASG9zdEJpbmRpbmcoJ2NsYXNzLm9wZW5lZCcpIG9wZW5lZCA9IGZhbHNlO1xuICBASG9zdEJpbmRpbmcoJ2NsYXNzLmNsb3NlZCcpIGNsb3NlZCA9IGZhbHNlO1xuXG5cblx0cHJpdmF0ZSByZWFkb25seSBfdG9nZ2xlRnVuYyA9IHRoaXMudG9nZ2xlLmJpbmQodGhpcyk7XG5cdHByaXZhdGUgcmVhZG9ubHkgX29wZW5GdW5jID0gdGhpcy5vcGVuLmJpbmQodGhpcyk7XG5cdHByaXZhdGUgcmVhZG9ubHkgX2Nsb3NlRnVuYyA9IHRoaXMuY2xvc2UuYmluZCh0aGlzKTtcblxuICAgIHByaXZhdGUgX3ZpZXdJbml0aWFsaXplID0gZmFsc2U7XG5cblx0QElucHV0KCkgc2V0IHRhcmdldFJlZih0YXJnZXRSZWY6IGFueSkge1xuXHRcdGlmICh0aGlzLnRyaWdnZXIgPT09ICdjbGljaycpIHtcblx0XHRcdGlmICh0aGlzLl90YXJnZXRSZWYpIHtcblx0XHRcdFx0dGhpcy5fdGFyZ2V0UmVmLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5fdG9nZ2xlRnVuYyk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLl90YXJnZXRSZWYgPSB0YXJnZXRSZWY7XG5cdFx0XHRpZiAodGhpcy5fdGFyZ2V0UmVmKSB7XG5cdFx0XHRcdHRoaXMuX3RhcmdldFJlZi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX3RvZ2dsZUZ1bmMpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRlbHNlIGlmICh0aGlzLnRyaWdnZXIgPT09ICdob3ZlcicpIHtcblx0XHRcdGlmICh0aGlzLl90YXJnZXRSZWYpIHtcblx0XHRcdFx0dGhpcy5fdGFyZ2V0UmVmLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsIHRoaXMuX29wZW5GdW5jKTtcblx0XHRcdFx0dGhpcy5fdGFyZ2V0UmVmLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlb3V0JywgdGhpcy5fY2xvc2VGdW5jKTtcblx0XHRcdH1cblx0XHRcdHRoaXMuX3RhcmdldFJlZiA9IHRhcmdldFJlZjtcblx0XHRcdGlmICh0aGlzLl90YXJnZXRSZWYpIHtcblx0XHRcdFx0dGhpcy5fdGFyZ2V0UmVmLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsIHRoaXMuX29wZW5GdW5jKTtcblx0XHRcdFx0dGhpcy5fdGFyZ2V0UmVmLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3V0JywgdGhpcy5fY2xvc2VGdW5jKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0Z2V0IHRhcmdldFJlZigpOiBhbnkgeyByZXR1cm4gdGhpcy5fdGFyZ2V0UmVmOyB9XG5cblx0QElucHV0KCkgc2V0IHBhcmVudFBvcHVwKHBhcmVudFBvcHVwOiBQb3B1cFdpZGdldENvbXBvbmVudCl7XG5cdFx0dGhpcy5fcGFyZW50UG9wdXAgPSBwYXJlbnRQb3B1cDtcblx0XHRpZiAodGhpcy5fc3RhdGVDaGFuZ2VTdWJzY3JpcHRpb24pe1xuXHRcdFx0dGhpcy5fc3RhdGVDaGFuZ2VTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcblx0XHRcdHRoaXMuX3N0YXRlQ2hhbmdlU3Vic2NyaXB0aW9uID0gbnVsbDtcblx0XHR9XG5cdFx0aWYgKHRoaXMuX3BhcmVudFBvcHVwKSB7XG5cdFx0XHR0aGlzLl9zdGF0ZUNoYW5nZVN1YnNjcmlwdGlvbiA9IHRoaXMuX3BhcmVudFBvcHVwLnN0YXRlJC5zdWJzY3JpYmUoZXZlbnQgPT4ge1xuXHRcdFx0XHRpZiAoZXZlbnQuc3RhdGUgPT09IFBvcHVwV2lkZ2V0U3RhdGVzLkNsb3NlKSB7XG5cdFx0XHRcdFx0dGhpcy5jbG9zZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cblx0Z2V0IHBhcmVudFBvcHVwKCk6IFBvcHVwV2lkZ2V0Q29tcG9uZW50IHsgcmV0dXJuIHRoaXMuX3BhcmVudFBvcHVwOyB9XG5cblx0QE91dHB1dCgpIG9uT3BlbiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuICAgIEBPdXRwdXQoKSBvbkNsb3NlID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cblx0cHJpdmF0ZSBfdGFyZ2V0UmVmOiBhbnk7XG4gICAgcHJpdmF0ZSBfc2F2ZVNjcm9sbFBvc2l0aW9uOiBudW1iZXI7XG5cdHB1YmxpYyBfcG9wdXBXaWRnZXRIZWlnaHQ6IHN0cmluZztcbiAgICBwcml2YXRlIF9tb2RhbE92ZXJsYXk6IGFueTtcblx0cHJpdmF0ZSBfcGFyZW50UG9wdXA6IFBvcHVwV2lkZ2V0Q29tcG9uZW50O1xuXHRwcml2YXRlIF9zdGF0ZUNoYW5nZVN1YnNjcmlwdGlvbjogSVN1YnNjcmlwdGlvbiA9IG51bGw7XG5cdHByaXZhdGUgX3N0YXRlY2hhbmdlOiBCZWhhdmlvclN1YmplY3Q8cG9wdXBTdGF0dXM+ID0gbmV3IEJlaGF2aW9yU3ViamVjdDxwb3B1cFN0YXR1cz4oe3N0YXRlOiAnJ30pO1xuXG5cdHB1YmxpYyBzdGF0ZSQ6IE9ic2VydmFibGU8cG9wdXBTdGF0dXM+ID0gdGhpcy5fc3RhdGVjaGFuZ2UuYXNPYnNlcnZhYmxlKCk7XG5cbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgcG9wdXA6IEVsZW1lbnRSZWYsIHByaXZhdGUgcmVuZGVyZXI6IFJlbmRlcmVyMikge1xuXHQgICAgdGhpcy5fc3RhdGVjaGFuZ2UubmV4dCh7c3RhdGU6IFBvcHVwV2lkZ2V0U3RhdGVzLkNsb3NlfSk7XG4gICAgICB0aGlzLnN0YXRlJFxuICAgICAgICAucGlwZShjYW5jZWxPbkRlc3Ryb3kodGhpcykpXG4gICAgICAgIC5zdWJzY3JpYmUoKHsgc3RhdGUgfSkgPT4ge1xuICAgICAgICAgIHRoaXMuY2xvc2VkID0gc3RhdGUgPT09IFBvcHVwV2lkZ2V0U3RhdGVzLkNsb3NlO1xuICAgICAgICAgIHRoaXMub3BlbmVkID0gc3RhdGUgPT09IFBvcHVwV2lkZ2V0U3RhdGVzLk9wZW47XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIHB1YmxpYyBBUEkgbWV0aG9kc1xuICAgIG9wZW4oKXtcblx0XHRpZiAodGhpcy5pc0VuYWJsZWQgJiYgdGhpcy52YWxpZGF0ZSgpKSB7XG5cdCAgICAgICAgLy8gaGFuZGxlIGF1dG8gaGVpZ2h0XG5cdFx0XHRpZiAoIXRoaXMucG9wdXBIZWlnaHQgIHx8IHRoaXMucG9wdXBIZWlnaHQgPT09ICdhdXRvJyl7XG5cdFx0XHRcdGlmICh0aGlzLnNsaWRlcikge1xuXHRcdFx0XHRcdHRoaXMuX3BvcHVwV2lkZ2V0SGVpZ2h0ID0gJ2NhbGMoMTAwdmggLSA4MHB4KSc7XG5cdFx0XHRcdH1lbHNlIHtcblx0XHRcdFx0XHR0aGlzLl9wb3B1cFdpZGdldEhlaWdodCA9ICdhdXRvJztcblx0XHRcdFx0fVxuXHQgICAgICAgIH0gZWxzZVxuXHQgICAgICAgIHtcblx0XHQgICAgICAgIHRoaXMuX3BvcHVwV2lkZ2V0SGVpZ2h0ID0gdGhpcy5wb3B1cEhlaWdodCArIFwicHhcIjtcblx0ICAgICAgICB9XG5cdFx0XHR0aGlzLl9zYXZlU2Nyb2xsUG9zaXRpb24gPSB3aW5kb3cucGFnZVlPZmZzZXQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDtcbiAgICAgICAgICAgIC8vIHNldCBsb2NhdGlvbiBhY2NvcmRpbmcgdG8gdGFyZ2V0UmVmXG5cdCAgICAgICAgY29uc3QgcGFyZW50TGVmdCA9IHRoaXMuYXBwZW5kVG8gJiYgIXRoaXMubW9kYWwgPyB0aGlzLmFwcGVuZFRvLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQgOiAwO1xuXHQgICAgICAgIGNvbnN0IHBhcmVudFRvcCA9IHRoaXMuYXBwZW5kVG8gJiYgIXRoaXMubW9kYWwgPyB0aGlzLmFwcGVuZFRvLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCA6IDA7XG5cdCAgICAgICAgLy8gY2VudGVyIG9uIHNjcmVlbiBpZiBubyB0YXJnZXRSZWYgd2FzIGRlZmluZWRcblx0ICAgICAgICBpZiAoIXRoaXMuX3RhcmdldFJlZil7XG5cdCAgICAgICAgXHRpZiAodGhpcy5mdWxsU2NyZWVuKXtcblx0ICAgICAgICBcdFx0dGhpcy5tb2RhbCA9IGZhbHNlO1xuXHQgICAgICAgIFx0XHR0aGlzLnByZXZlbnRQYWdlU2Nyb2xsID0gdHJ1ZTtcblx0XHRcdCAgICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLnBvcHVwLm5hdGl2ZUVsZW1lbnQsICdmdWxsU2NyZWVuJyk7XG5cdFx0ICAgICAgICB9ZWxzZSB7XG5cdFx0XHQgICAgICAgIHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5zdHlsZS5tYXJnaW5MZWZ0ID0gd2luZG93LmlubmVyV2lkdGggLyAyIC0gdGhpcy5wb3B1cFdpZHRoIC8gMiArICdweCc7XG5cdFx0XHQgICAgICAgIGlmICh0aGlzLnNsaWRlcikge1xuXHRcdFx0XHQgICAgICAgIHdpbmRvdy5zY3JvbGxUbygwLCAwKTtcblx0XHRcdFx0ICAgICAgICB0aGlzLnBvcHVwLm5hdGl2ZUVsZW1lbnQuc3R5bGUudG9wID0gXCJhdXRvXCI7XG5cdFx0XHRcdCAgICAgICAgdGhpcy5jbG9zZUJ0biA9IGZhbHNlO1xuXHRcdFx0XHQgICAgICAgIHRoaXMucHJldmVudFBhZ2VTY3JvbGwgPSB0cnVlO1xuXHRcdFx0XHQgICAgICAgIHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5zdHlsZS5ib3R0b20gPSB0aGlzLnBvcHVwSGVpZ2h0ICE9PSAnYXV0bycgPyB0aGlzLnBvcHVwSGVpZ2h0ICogLTEgKyBcInB4XCIgOiBcIi0xMDAwcHhcIjtcblx0XHRcdFx0ICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHQgICAgICAgIHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5zdHlsZS5ib3R0b20gPSAwICsgXCJweFwiOyAvLyB1c2UgdGltZW91dCB0byBpbnZva2UgYW5pbWF0aW9uXG5cdFx0XHRcdCAgICAgICAgfSwgMCk7XG5cdFx0XHQgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbWFyZ2luVG9wID0gKHdpbmRvdy5pbm5lckhlaWdodCAvIDIgLSAxMDAgLyAyKTtcblx0XHRcdFx0ICAgICAgICB0aGlzLnBvcHVwLm5hdGl2ZUVsZW1lbnQuc3R5bGUubWFyZ2luVG9wID0gbWFyZ2luVG9wICsgJ3B4Jztcblx0XHRcdFx0ICAgICAgICB0aGlzLnBvcHVwLm5hdGl2ZUVsZW1lbnQuc3R5bGUucG9zaXRpb24gPSBcImZpeGVkXCI7XG5cdFx0XHQgICAgICAgIH1cblx0XHQgICAgICAgIH1cblx0ICAgICAgICB9ZWxzZXtcblx0XHQgICAgICAgIHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5zdHlsZS5tYXJnaW5MZWZ0ID0gdGhpcy5fdGFyZ2V0UmVmLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQgLSBwYXJlbnRMZWZ0ICsgdGhpcy50YXJnZXRPZmZzZXRbJ3gnXSArICdweCc7XG5cdFx0ICAgICAgICB0aGlzLnBvcHVwLm5hdGl2ZUVsZW1lbnQuc3R5bGUubWFyZ2luVG9wID0gdGhpcy5fdGFyZ2V0UmVmLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCAtIHBhcmVudFRvcCArIHRoaXMudGFyZ2V0T2Zmc2V0Wyd5J10gKyAncHgnO1xuXHRcdCAgICAgICAgdGhpcy5wb3B1cC5uYXRpdmVFbGVtZW50LnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xuXHQgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5zdHlsZS56SW5kZXggPSBQb3B1cFdpZGdldExheW91dC5nZXRQb3B1cFppbmRleCh0aGlzLmZ1bGxTY3JlZW4pO1xuXG4gICAgICAgICAgICAvLyBoYW5kbGUgbW9kYWxcblx0ICAgICAgICBpZiAoIXRoaXMuX21vZGFsT3ZlcmxheSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnRyaWdnZXIgIT09ICdob3ZlcicpIHt0aGlzLl9tb2RhbE92ZXJsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5tb2RhbCB8fCB0aGlzLnNsaWRlcikge1xuXHQgICAgICAgICAgICAgICAgdGhpcy5fbW9kYWxPdmVybGF5LmNsYXNzTmFtZSA9IFwia1BvcHVwV2lkZ2V0TW9kYWxPdmVybGF5XCI7XG4gICAgICAgICAgICAgICAgfWVsc2V7XG5cdCAgICAgICAgICAgICAgICB0aGlzLl9tb2RhbE92ZXJsYXkuY2xhc3NOYW1lID0gXCJrUG9wdXBXaWRnZXRNb2RhbE92ZXJsYXkga1RyYW5zcGFyZW50XCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX21vZGFsT3ZlcmxheS5zdHlsZS56SW5kZXggPSB0aGlzLnBvcHVwLm5hdGl2ZUVsZW1lbnQuc3R5bGUuekluZGV4IC0gMTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuc2xpZGVyICYmIHRoaXMuY2xvc2VPbkNsaWNrT3V0c2lkZSkge1xuXHQgICAgICAgICAgICAgICAgdGhpcy5fbW9kYWxPdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2ZW50OiBhbnkpID0+IHtcblx0XHQgICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0ICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcblx0ICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYXBwZW5kVG8pe1xuXHRcdFx0ICAgICAgICB0aGlzLmFwcGVuZENoaWxkKHRoaXMuX21vZGFsT3ZlcmxheSwgdGhpcy5hcHBlbmRUbyk7XG5cdFx0ICAgICAgICB9ZWxzZSB7ICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuX21vZGFsT3ZlcmxheSk7fVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm1vZGFsIHx8IHRoaXMuc2xpZGVyKSB7XG5cdCAgICAgICAgICAgICAgICBQb3B1cFdpZGdldExheW91dC5pbmNyZWFzZU1vZGFsQ291bnQoKTtcblx0ICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIHByZXZlbnQgcGFnZSBzY3JvbGxcblx0ICAgICAgICBpZiAodGhpcy5wcmV2ZW50UGFnZVNjcm9sbCl7XG5cdCAgICAgICAgXHRkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93WSA9ICdoaWRkZW4nO1xuXHQgICAgICAgIFx0ZG9jdW1lbnQuYm9keS5zdHlsZS5wb3NpdGlvbiA9ICdmaXhlZCc7XG5cdCAgICAgICAgfVxuXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpPT57XG5cdCAgICAgICAgICAgIHRoaXMuYWRkQ2xpY2tPdXRzaWRlU3VwcG9ydCgpO1xuICAgICAgICAgICAgfSwwKTtcblxuICAgICAgICAgICAgdGhpcy5vbk9wZW4uZW1pdCgpOyAvLyBkaXNwYXRjaCBvbk9wZW4gZXZlbnQgKEFQSSlcbiAgICAgICAgICAgIHRoaXMuX3N0YXRlY2hhbmdlLm5leHQoe3N0YXRlOiBQb3B1cFdpZGdldFN0YXRlcy5PcGVufSk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmNsb3NlT25TY3JvbGwgJiYgdGhpcy5pc1Nob3cpIHtcbiAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHRoaXMuX2Nsb3NlRnVuYyk7XG4gICAgICAgICAgICB9XG5cblx0XHR9XG5cdCAgICBpZiAoIXRoaXMuc2xpZGVyICYmICF0aGlzLmZ1bGxTY3JlZW4gJiYgdGhpcy5wb3B1cC5uYXRpdmVFbGVtZW50KSB7XG5cdFx0ICAgIHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5zdHlsZS5vcGFjaXR5ID0gMDtcblx0ICAgIH1cblx0ICAgIC8vIGF1dG8gcG9zaXRpb25pbmcgbmVlZCBmaXJzdCB0aGUgZG9tIHRvIHJlbmRlclxuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGhpcy5zZXRQb3NpdGlvbigpO1xuXHRcdH0sIDApO1xuICAgIH1cblxuICAgIGNsb3NlKGNvbnRleHQ6IGFueSA9IG51bGwsIHJlYXNvbjogc3RyaW5nID0gbnVsbCl7XG4gICAgICAgIGlmICh0aGlzLmlzRW5hYmxlZCAmJiB0aGlzLmlzU2hvdykge1xuICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB0aGlzLl9jbG9zZUZ1bmMpO1xuXHQgICAgICAgIGlmICh0aGlzLmZ1bGxTY3JlZW4pe1xuXHRcdCAgICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVDbGFzcyh0aGlzLnBvcHVwLm5hdGl2ZUVsZW1lbnQsICdmdWxsU2NyZWVuJyk7XG5cdCAgICAgICAgfVxuXHRcdFx0Ly8gYWxsb3cgY2FuY2VsbGluZyB0aGUgY2xvc2Ugb3BlcmF0aW9uXG5cdCAgICAgICAgbGV0IGJlZm9yZUNsb3NlQ29udGV4dCA9IHtcImFsbG93Q2xvc2VcIjogdHJ1ZX07XG5cdCAgICAgICAgdGhpcy5fc3RhdGVjaGFuZ2UubmV4dCh7c3RhdGU6IFBvcHVwV2lkZ2V0U3RhdGVzLkJlZm9yZUNsb3NlLCBjb250ZXh0OiBiZWZvcmVDbG9zZUNvbnRleHR9KTtcblx0ICAgICAgICBpZiAoYmVmb3JlQ2xvc2VDb250ZXh0WydhbGxvd0Nsb3NlJ10pIHtcblx0XHQgICAgICAgIC8vIGNsb3NlIGNoaWxkcmVuIHBvcHVwcyBpZiBleGlzdFxuXHRcdCAgICAgICAgaWYgKHRoaXMuY2hpbGRyZW5Qb3B1cHMubGVuZ3RoKSB7XG5cdFx0XHQgICAgICAgIHRoaXMuY2hpbGRyZW5Qb3B1cHMuZm9yRWFjaCgocG9wdXA6IFBvcHVwV2lkZ2V0Q29tcG9uZW50KSA9PiB7XG5cdFx0XHRcdCAgICAgICAgcG9wdXAuY2xvc2UoKTtcblx0XHRcdCAgICAgICAgfSk7XG5cdFx0ICAgICAgICB9XG5cdFx0ICAgICAgICB0aGlzLnJlbW92ZUNsaWNrT3V0c2lkZVN1cHBvcnQoKTtcblx0XHQgICAgICAgIHRoaXMucmVzdG9yZVBhZ2VTY3JvbGwodHJ1ZSk7XG5cdFx0ICAgICAgICB0aGlzLm9uQ2xvc2UuZW1pdCgpOyAvLyBkaXNwYXRjaCBvbkNsb3NlIGV2ZW50IChBUEkpXG5cdFx0ICAgICAgICBsZXQgdGltZW91dCA9IDA7XG5cdFx0ICAgICAgICBpZiAodGhpcy5zbGlkZXIpe1xuXHRcdFx0ICAgICAgICB0aGlzLnBvcHVwLm5hdGl2ZUVsZW1lbnQuc3R5bGUuYm90dG9tID0gdGhpcy5wb3B1cEhlaWdodCE9PSAnYXV0bycgPyAgdGhpcy5wb3B1cEhlaWdodCAqIC0xICtcInB4XCIgOiAgXCItMTAwMHB4XCI7XG5cdFx0XHQgICAgICAgIHRpbWVvdXQgPSAzMDA7XG5cdFx0ICAgICAgICB9XG5cdFx0ICAgICAgICBpZiAodGhpcy5tb2RhbCAmJiAhdGhpcy5zbGlkZXIpIHtcblx0XHRcdCAgICAgICAgUG9wdXBXaWRnZXRMYXlvdXQuZGVjcmVhc2VNb2RhbENvdW50KCk7XG5cdFx0ICAgICAgICB9XG5cdFx0ICAgICAgICBzZXRUaW1lb3V0KCgpPT57XG5cdFx0XHQgICAgICAgIC8vIHJlbW92ZSBtb2RhbFxuXHRcdFx0ICAgICAgICBpZiAodGhpcy5fbW9kYWxPdmVybGF5KSB7XG5cdFx0XHRcdCAgICAgICAgaWYgKHRoaXMuYXBwZW5kVG8pe1xuXHRcdFx0XHRcdCAgICAgICAgdGhpcy5yZW1vdmVDaGlsZCh0aGlzLl9tb2RhbE92ZXJsYXksIHRoaXMuYXBwZW5kVG8pO1xuXHRcdFx0XHQgICAgICAgIH1lbHNlIHtcblx0XHRcdFx0XHQgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQodGhpcy5fbW9kYWxPdmVybGF5KTtcblx0XHRcdFx0ICAgICAgICB9XG5cdFx0XHRcdCAgICAgICAgdGhpcy5fbW9kYWxPdmVybGF5ID0gbnVsbDtcblx0XHRcdCAgICAgICAgfVxuXHRcdFx0ICAgICAgICBpZiAodGhpcy5zbGlkZXIpIHtcblx0XHRcdFx0ICAgICAgICBQb3B1cFdpZGdldExheW91dC5kZWNyZWFzZU1vZGFsQ291bnQoKTtcblx0XHRcdCAgICAgICAgfVxuXHRcdFx0ICAgICAgICB0aGlzLl9zdGF0ZWNoYW5nZS5uZXh0KHtzdGF0ZTogUG9wdXBXaWRnZXRTdGF0ZXMuQ2xvc2UsIGNvbnRleHQ6IGNvbnRleHQsIHJlYXNvbjogcmVhc29ufSk7IC8vIHVzZSB0aW1lb3V0IHRvIHByZXZlbnQgdmFsdWVDaGFuZ2VBZnRlckNoZWNrZWQgZXJyb3Jcblx0XHQgICAgICAgIH0sdGltZW91dCk7XG5cdCAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICB0b2dnbGUoKXtcbiAgICAgICAgaWYgKHRoaXMuaXNFbmFibGVkKSB7XG4gICAgICAgICAgICB0aGlzLmlzU2hvdyA/IHRoaXMuY2xvc2UoKSA6IHRoaXMub3BlbigpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0IGlzU2hvdygpOiBib29sZWFuIHtcbiAgICBcdHJldHVybiB0aGlzLl9zdGF0ZWNoYW5nZS5nZXRWYWx1ZSgpLnN0YXRlICE9PSBQb3B1cFdpZGdldFN0YXRlcy5DbG9zZTtcbiAgICB9XG5cbiAgICBnZXQgaXNFbmFibGVkKCk6IGJvb2xlYW4ge1xuICAgIFx0cmV0dXJuIHRoaXMuX3N0YXRlY2hhbmdlLmdldFZhbHVlKCkuc3RhdGUgIT09IFBvcHVwV2lkZ2V0U3RhdGVzLkRpc2FibGVkO1xuICAgIH1cblxuXG5cblxuXHRASG9zdExpc3RlbmVyKFwid2luZG93OnJlc2l6ZVwiLCBbXSlcblx0b25XaW5kb3dSZXNpemUoKSB7XG5cdFx0aWYgKHRoaXMuY2xvc2VPblJlc2l6ZSkge1xuXHRcdFx0dGhpcy5jbG9zZSgpO1xuXHRcdH1lbHNle1xuXHRcdFx0dGhpcy5zZXRQb3NpdGlvbigpO1xuXHRcdH1cblx0fVxuXG4gIEBIb3N0TGlzdGVuZXIoJ3dpbmRvdzpwb3BzdGF0ZScsIFsnJGV2ZW50J10pXG4gIG9uUG9wU3RhdGUoZXZlbnQpIHtcbiAgICBpZiAodGhpcy5jbG9zZU9uQnJvd3Nlck5hdikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gICAgLy8gY29tcG9uZW50IGxpZmVjeWNsZSBldmVudHNcbiAgICBuZ0FmdGVyVmlld0luaXQoKSB7XG5cdFx0dGhpcy5fdmlld0luaXRpYWxpemUgPSB0cnVlO1xuXG4gICAgICAgIGlmICh0aGlzLnZhbGlkYXRlKCkpIHtcblx0XHRcdGlmICh0aGlzLmFwcGVuZFRvICYmICF0aGlzLm1vZGFsKXtcblx0XHRcdFx0dGhpcy5hcHBlbmRDaGlsZCh0aGlzLnBvcHVwLm5hdGl2ZUVsZW1lbnQsIHRoaXMuYXBwZW5kVG8pO1xuXHQgICAgICAgIH1lbHNlIHtcblx0XHQgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5wb3B1cC5uYXRpdmVFbGVtZW50KTtcblx0XHQgICAgICAgIGlmICh0aGlzLmFwcGVuZFRvKXtcblx0XHQgICAgICAgIFx0Y29uc29sZS53YXJuKFwiW2thbHR1cmFdIC0+IElnbm9yaW5nIGFwcGVuZCB0byBcIiArIHRoaXMuYXBwZW5kVG8gKyBcIiBzaW5jZSBwb3B1cCBpcyBzZXQgdG8gbW9kYWw9dHJ1ZS5cIik7IC8vIGtlZXAgd2FybmluZ1xuXHRcdCAgICAgICAgfVxuXHRcdFx0fVxuXHQgICAgICAgIGlmICh0aGlzLmZ1bGxTY3JlZW4pe1xuXHRcdCAgICAgICAgdGhpcy5wb3B1cC5uYXRpdmVFbGVtZW50LnN0eWxlLndpZHRoID0gJzBweCc7XG5cdFx0ICAgICAgICB0aGlzLnBvcHVwLm5hdGl2ZUVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gJzBweCc7XG5cdCAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgbmdPbkRlc3Ryb3koKXtcblxuICAgIFx0aWYgKHRoaXMuX3RhcmdldFJlZilcbiAgICBcdHtcblx0XHR0aGlzLl90YXJnZXRSZWYucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl90b2dnbGVGdW5jKTtcblx0XHR0aGlzLl90YXJnZXRSZWYucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywgdGhpcy5fb3BlbkZ1bmMpO1xuXHRcdHRoaXMuX3RhcmdldFJlZi5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsIHRoaXMuX2Nsb3NlRnVuYyk7XG4gICAgXHR9XG5cbiAgICAgICAgaWYgKHRoaXMuX3N0YXRlQ2hhbmdlU3Vic2NyaXB0aW9uKXtcbiAgICAgICAgICAgIHRoaXMuX3N0YXRlQ2hhbmdlU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgIH1cblx0ICAgIHRoaXMuX3N0YXRlY2hhbmdlLmNvbXBsZXRlKCk7XG4gICAgICAgIHRoaXMucmVtb3ZlQ2xpY2tPdXRzaWRlU3VwcG9ydCgpO1xuICAgICAgICB0aGlzLnJlc3RvcmVQYWdlU2Nyb2xsKGZhbHNlKTtcblx0ICAgIGlmICh0aGlzLm1vZGFsICYmIHRoaXMuX21vZGFsT3ZlcmxheSkge1xuXHRcdCAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHRoaXMuX21vZGFsT3ZlcmxheSk7XG5cdFx0ICAgIHRoaXMuX21vZGFsT3ZlcmxheSA9IG51bGw7XG5cdCAgICB9XG5cdCAgICBpZiAodGhpcy5hcHBlbmRUbyAmJiAhdGhpcy5tb2RhbCl7XG5cdFx0ICAgIHRoaXMucmVtb3ZlQ2hpbGQodGhpcy5wb3B1cC5uYXRpdmVFbGVtZW50LCB0aGlzLmFwcGVuZFRvKTtcblx0ICAgIH1lbHNlIHtcblx0ICAgIFx0aWYgKHRoaXMuX3ZpZXdJbml0aWFsaXplKSB7XG4gICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCh0aGlzLnBvcHVwLm5hdGl2ZUVsZW1lbnQpO1xuXHRcdFx0XHR9XG5cdCAgICB9XG5cbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB0aGlzLl9jbG9zZUZ1bmMpO1xuICAgIH1cblxuICAgIC8vIHByaXZhdGUgbWV0aG9kc1xuXG4gICAgcHJpdmF0ZSBhZGRDbGlja091dHNpZGVTdXBwb3J0KCl7XG4gICAgICAgIGlmICh0aGlzLmNsb3NlT25DbGlja091dHNpZGUpe1xuICAgICAgICAgICAgdGhpcy5wb3B1cC5uYXRpdmVFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuYmxvY2tNb3VzZURvd25IYW5kbGVyKTtcblx0ICAgICAgICBpZiAodGhpcy50YXJnZXRSZWYpIHtcblx0XHQgICAgICAgIHRoaXMudGFyZ2V0UmVmLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuYmxvY2tNb3VzZURvd25IYW5kbGVyKTtcblx0ICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGJsb2NrTW91c2VEb3duSGFuZGxlcihldmVudDogYW55KXtcblx0ICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVtb3ZlQ2xpY2tPdXRzaWRlU3VwcG9ydCgpe1xuICAgICAgICBpZiAodGhpcy5jbG9zZU9uQ2xpY2tPdXRzaWRlKXtcbiAgICAgICAgICAgIHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLmJsb2NrTW91c2VEb3duSGFuZGxlcik7XG5cdCAgICAgICAgaWYgKHRoaXMudGFyZ2V0UmVmKSB7XG5cdFx0ICAgICAgICB0aGlzLnRhcmdldFJlZi5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLmJsb2NrTW91c2VEb3duSGFuZGxlcik7XG5cdCAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZXN0b3JlUGFnZVNjcm9sbChyZXN0b3JlU2Nyb2xsUG9zaXRpb24gPSB0cnVlKTp2b2lke1xuXHQgICAgaWYgKHRoaXMucHJldmVudFBhZ2VTY3JvbGwpe1xuXHRcdCAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93WSA9ICdhdXRvJztcblx0XHQgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5wb3NpdGlvbiA9ICcnO1xuXHRcdCAgICBpZiAocmVzdG9yZVNjcm9sbFBvc2l0aW9uKSB7XG5cdFx0XHQgICAgd2luZG93LnNjcm9sbFRvKDAsIHRoaXMuX3NhdmVTY3JvbGxQb3NpdGlvbik7XG5cdFx0ICAgIH1cblx0ICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHZhbGlkYXRlKCl7XG4gICAgICAgIGxldCB2YWxpZDogYm9vbGVhbiA9IHR5cGVvZiB0aGlzLnBvcHVwV2lkdGggIT09ICd1bmRlZmluZWQnIHx8IHRoaXMuZnVsbFNjcmVlbjtcbiAgICAgICAgaWYgKCF2YWxpZCl7XG5cdCAgICAgICAgdGhpcy5fc3RhdGVjaGFuZ2UubmV4dCh7c3RhdGU6IFBvcHVwV2lkZ2V0U3RhdGVzLkRpc2FibGVkfSk7XG5cdCAgICAgICAgdGhyb3cgXCJQb3B1cCB3aWRnZXQgZXJyb3I6IG1pc3NpbmcgcmVxdWlyZWQgcGFyYW1ldGVycy4gVmVyaWZ5IHBvcHVwV2lkdGggaXMgZGVmaW5lZC5cIjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsaWQ7XG4gICAgfVxuXG5cdHByaXZhdGUgYXBwZW5kQ2hpbGQoZWxlbWVudDogYW55LCB0YXJnZXQ6IGFueSkge1xuXHRcdGlmICh0aGlzLmlzRWxlbWVudCh0YXJnZXQpKSB7XG5cdFx0XHR0YXJnZXQuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XG5cdFx0fWVsc2Uge1xuXHRcdFx0dGhyb3cgJ0Nhbm5vdCBhcHBlbmQgJyArIHRhcmdldCArICcgdG8gJyArIGVsZW1lbnQ7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSByZW1vdmVDaGlsZChlbGVtZW50OiBhbnksIHRhcmdldDogYW55KSB7XG5cdFx0aWYgKHRoaXMuaXNFbGVtZW50KHRhcmdldCkpIHtcblx0XHRcdHRhcmdldC5yZW1vdmVDaGlsZChlbGVtZW50KTtcblx0XHR9ZWxzZSB7XG5cdFx0XHR0aHJvdyAnQ2Fubm90IHJlbW92ZSAnICsgdGFyZ2V0ICsgJyBmcm9tICcgKyBlbGVtZW50O1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgaXNFbGVtZW50KG9iajogYW55KSB7XG5cdFx0cmV0dXJuICh0eXBlb2YgSFRNTEVsZW1lbnQgPT09IFwib2JqZWN0XCIgPyBvYmogaW5zdGFuY2VvZiBIVE1MRWxlbWVudCA6XG5cdFx0XHRvYmogJiYgdHlwZW9mIG9iaiA9PT0gXCJvYmplY3RcIiAmJiBvYmogIT09IG51bGwgJiYgb2JqLm5vZGVUeXBlID09PSAxICYmIHR5cGVvZiBvYmoubm9kZU5hbWUgPT09IFwic3RyaW5nXCJcblx0XHQpO1xuXHR9XG5cblx0cHJpdmF0ZSBzZXRQb3NpdGlvbigpIHtcbiAgICBjb25zdCBwb3B1cEhlaWdodCA9IHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5jbGllbnRIZWlnaHQ7XG5cdFx0Y29uc3QgcG9wdXBXaWR0aCA9IHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5jbGllbnRXaWR0aDtcblxuICAgIGlmICh0aGlzLm1vZGFsIHx8IHRoaXMuc2xpZGVyKSB7XG4gICAgICB0aGlzLnBvcHVwLm5hdGl2ZUVsZW1lbnQuc3R5bGUubWFyZ2luTGVmdCA9IHdpbmRvdy5pbm5lcldpZHRoIC8gMiAtIHRoaXMucG9wdXBXaWR0aCAvIDIgKyAncHgnO1xuXG4gICAgICBpZiAodGhpcy5tb2RhbCkge1xuICAgICAgICBjb25zdCBtb2RhbE1hcmdpblRvcCA9IChcbiAgICAgICAgICB3aW5kb3cuaW5uZXJIZWlnaHQgLyAyIC1cbiAgICAgICAgICBwb3B1cEhlaWdodCAvIDJcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5wb3B1cC5uYXRpdmVFbGVtZW50LnN0eWxlLm1hcmdpblRvcCA9IE1hdGgucm91bmQobW9kYWxNYXJnaW5Ub3ApICsgJ3B4JztcbiAgICAgICAgdGhpcy5wb3B1cC5uYXRpdmVFbGVtZW50LnN0eWxlLm9wYWNpdHkgPSAxO1xuICAgICAgfVxuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRpZiAoIXRoaXMuX3RhcmdldFJlZikgcmV0dXJuO1xuXG5cdFx0Y29uc3QgcG9wdXBCb3ggPSB0aGlzLnBvcHVwLm5hdGl2ZUVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0Y29uc3QgdGFyZ2V0UmVmQm94ID0gdGhpcy5fdGFyZ2V0UmVmLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRcdGNvbnN0IHBhcmVudFRvcCA9IHRoaXMuYXBwZW5kVG8gJiYgIXRoaXMubW9kYWwgPyB0aGlzLmFwcGVuZFRvLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCA6IDA7XG5cdFx0Y29uc3QgcGFyZW50TGVmdCA9IHRoaXMuYXBwZW5kVG8gJiYgIXRoaXMubW9kYWwgPyB0aGlzLmFwcGVuZFRvLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQgOiAwO1xuXG5cdFx0bGV0IHBvcHVwTWFyZ2luVG9wOiBudW1iZXI7XG5cdFx0bGV0IHBvcHVwTWFyZ2luTGVmdDogbnVtYmVyO1xuXG5cdFx0bGV0IHBvcHVwTGVmdE1hcmdpbnM6IFBvcHVwV2lkZ2V0WE1hcmdpbnMgPSB7fVxuXHRcdGxldCBwb3B1cFRvcE1hcmdpbnM6IFBvcHVwV2lkZ2V0WU1hcmdpbnMgPSB7fVxuXG5cdFx0cG9wdXBUb3BNYXJnaW5zLnRvcCA9IChcblx0XHRcdHRhcmdldFJlZkJveC50b3Bcblx0XHRcdC0gcGFyZW50VG9wXG5cdFx0XHQtIHBvcHVwSGVpZ2h0XG5cdFx0XHQrIHRoaXMudGFyZ2V0UmVmLm9mZnNldEhlaWdodFxuXHRcdFx0LSB0aGlzLnRhcmdldE9mZnNldFsneSddXG5cdFx0KTtcblxuXHRcdHBvcHVwVG9wTWFyZ2lucy5ib3R0b20gPSAoXG5cdFx0XHR0YXJnZXRSZWZCb3gudG9wXG5cdFx0XHQtIHBhcmVudFRvcFxuXHRcdFx0KyB0aGlzLnRhcmdldE9mZnNldFsneSddXG5cdFx0KTtcblxuXHRcdHBvcHVwVG9wTWFyZ2lucy5jZW50ZXIgPSAoXG5cdFx0XHR0YXJnZXRSZWZCb3gudG9wXG5cdFx0XHQtIHBhcmVudFRvcFxuXHRcdFx0LSBwb3B1cEhlaWdodCAvIDJcblx0XHRcdCsgdGhpcy50YXJnZXRSZWYub2Zmc2V0SGVpZ2h0IC8gMlxuXHRcdFx0KyB0aGlzLnRhcmdldE9mZnNldFsneSddXG5cdFx0KTtcblxuXHRcdHBvcHVwTGVmdE1hcmdpbnMubGVmdCA9IChcblx0XHRcdHRhcmdldFJlZkJveC5sZWZ0XG5cdFx0XHQtIHBhcmVudExlZnRcblx0XHRcdC0gcG9wdXBXaWR0aFxuXHRcdFx0KyB0aGlzLnRhcmdldFJlZi5jbGllbnRXaWR0aFxuXHRcdFx0LSB0aGlzLnRhcmdldE9mZnNldFsneCddXG5cdFx0KTtcblxuXHRcdHBvcHVwTGVmdE1hcmdpbnMucmlnaHQgPSAoXG5cdFx0XHR0YXJnZXRSZWZCb3gubGVmdFxuXHRcdFx0LSBwYXJlbnRMZWZ0XG5cdFx0XHQrIHRoaXMudGFyZ2V0T2Zmc2V0Wyd4J11cblx0XHQpO1xuXG5cdFx0cG9wdXBMZWZ0TWFyZ2lucy5jZW50ZXIgPSAoXG5cdFx0XHR0YXJnZXRSZWZCb3gubGVmdFxuXHRcdFx0LSBwYXJlbnRMZWZ0XG5cdFx0XHQtIHBvcHVwV2lkdGggLyAyXG5cdFx0XHQrIHRoaXMudGFyZ2V0T2Zmc2V0Wyd4J11cblx0XHQpO1xuXG5cdFx0cG9wdXBNYXJnaW5Ub3AgPSB0aGlzLnBsYWNlbWVudC55ID8gcG9wdXBUb3BNYXJnaW5zW3RoaXMucGxhY2VtZW50LnldIDogcG9wdXBUb3BNYXJnaW5zLmJvdHRvbTtcblx0XHRwb3B1cE1hcmdpbkxlZnQgPSB0aGlzLnBsYWNlbWVudC54ID8gcG9wdXBMZWZ0TWFyZ2luc1t0aGlzLnBsYWNlbWVudC55XSA6IHBvcHVwTGVmdE1hcmdpbnMucmlnaHQ7XG5cblx0XHR0aGlzLnBvcHVwLm5hdGl2ZUVsZW1lbnQuc3R5bGUubWFyZ2luVG9wID0gTWF0aC5yb3VuZChwb3B1cE1hcmdpblRvcCkgKyAncHgnO1xuXHRcdHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5zdHlsZS5tYXJnaW5MZWZ0ID0gTWF0aC5yb3VuZChwb3B1cE1hcmdpbkxlZnQpICsgJ3B4JztcblxuXHRcdHRoaXMudmFsaWRhdGVQb3NpdGlvbihwb3B1cExlZnRNYXJnaW5zLCBwb3B1cFRvcE1hcmdpbnMpO1xuXHR9XG5cblx0Ly8gdmFsaWRhdGUgcG9wdXAgd2lkZ2V0IGlzIG5vdCBvdXRzaWRlIG9mIHRoZSB2aWV3cG9ydCAoKyBndXR0ZXIpIGFuZCBpZiBpdCBpcywgcmVwb3NpdGlvbiBpdFxuXHRwcml2YXRlIHZhbGlkYXRlUG9zaXRpb24ocG9wdXBMZWZ0TWFyZ2luczogUG9wdXBXaWRnZXRYTWFyZ2lucywgcG9wdXBUb3BNYXJnaW5zOiBQb3B1cFdpZGdldFlNYXJnaW5zKSB7XG5cblx0XHRjb25zdCBwb3B1cEhlaWdodCA9IHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5jbGllbnRIZWlnaHQ7XG5cdFx0Y29uc3QgcG9wdXBXaWR0aCA9IHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5jbGllbnRXaWR0aDtcblx0XHRjb25zdCBwb3B1cEJveCA9IHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XHRjb25zdCBjbGllbnRIZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XG5cdFx0Y29uc3QgY2xpZW50V2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcblxuXHRcdGxldCBwb3B1cE1hcmdpblRvcDogbnVtYmVyO1xuXHRcdGxldCBwb3B1cE1hcmdpbkxlZnQ6IG51bWJlcjtcblxuXHRcdGlmICh0aGlzLnBsYWNlbWVudC55ID09PSAndG9wJykge1xuXHRcdFx0aWYgKHBvcHVwQm94LnRvcCA8IFdJTkRPV19HVVRURVIpIHtcblx0XHRcdFx0cG9wdXBNYXJnaW5Ub3AgPSBwb3B1cFRvcE1hcmdpbnMuYm90dG9tO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRlbHNlIGlmICh0aGlzLnBsYWNlbWVudC55ID09PSAnYm90dG9tJykge1xuXHRcdFx0aWYgKHBvcHVwQm94LnRvcCArIHBvcHVwSGVpZ2h0ID4gY2xpZW50SGVpZ2h0IC0gV0lORE9XX0dVVFRFUiAmJiBwb3B1cEJveC50b3AgPiBjbGllbnRIZWlnaHQpIHtcblx0XHRcdFx0cG9wdXBNYXJnaW5Ub3AgPSBwb3B1cFRvcE1hcmdpbnMudG9wO1xuXHRcdFx0fWVsc2Uge1xuICAgICAgICBwb3B1cE1hcmdpblRvcCA9IHBvcHVwVG9wTWFyZ2lucy5ib3R0b207XG4gICAgICB9XG5cdFx0fVxuXHRcdGVsc2UgaWYgKHRoaXMucGxhY2VtZW50LnkgPT09ICdjZW50ZXInKSB7XG5cdFx0XHRpZiAocG9wdXBCb3gudG9wIDwgV0lORE9XX0dVVFRFUikge1xuXHRcdFx0XHRwb3B1cE1hcmdpblRvcCA9IHBvcHVwVG9wTWFyZ2lucy5ib3R0b207XG5cdFx0XHR9XG5cdFx0XHRlbHNlIGlmIChwb3B1cEJveC50b3AgKyBwb3B1cEhlaWdodCA+IGNsaWVudEhlaWdodCAtIFdJTkRPV19HVVRURVIpIHtcblx0XHRcdFx0cG9wdXBNYXJnaW5Ub3AgPSBwb3B1cFRvcE1hcmdpbnMudG9wO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmIChwb3B1cEJveC5sZWZ0ICsgcG9wdXBXaWR0aCA+IGNsaWVudFdpZHRoICsgV0lORE9XX0dVVFRFUikge1xuXHRcdFx0cG9wdXBNYXJnaW5MZWZ0ID0gcG9wdXBMZWZ0TWFyZ2lucy5sZWZ0O1xuXHRcdH1cblx0XHRlbHNlIGlmIChwb3B1cEJveC5sZWZ0IDwgV0lORE9XX0dVVFRFUikge1xuXHRcdFx0cG9wdXBNYXJnaW5MZWZ0ID0gcG9wdXBMZWZ0TWFyZ2lucy5yaWdodDtcblx0XHR9XG5cblx0XHR0aGlzLnBvcHVwLm5hdGl2ZUVsZW1lbnQuc3R5bGUubWFyZ2luVG9wID0gTWF0aC5yb3VuZChwb3B1cE1hcmdpblRvcCkgKyAncHgnO1xuXHRcdHRoaXMucG9wdXAubmF0aXZlRWxlbWVudC5zdHlsZS5tYXJnaW5MZWZ0ID0gTWF0aC5yb3VuZChwb3B1cE1hcmdpbkxlZnQpICsgJ3B4Jztcblx0XHR0aGlzLnBvcHVwLm5hdGl2ZUVsZW1lbnQuc3R5bGUub3BhY2l0eSA9IDE7XG5cdH1cblxufVxuIl19